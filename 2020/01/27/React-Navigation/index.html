<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>React Native | 星脉</title><meta name="description" content="React Native"><meta name="keywords" content="React,App"><meta name="author" content="wangguangatap"><meta name="copyright" content="wangguangatap"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="React Native"><meta name="twitter:description" content="React Native"><meta name="twitter:image" content="https://wangguangatap.github.io/img/react/react1.jpeg"><meta property="og:type" content="article"><meta property="og:title" content="React Native"><meta property="og:url" content="https://wangguangatap.github.io/2020/01/27/React-Navigation/"><meta property="og:site_name" content="星脉"><meta property="og:description" content="React Native"><meta property="og:image" content="https://wangguangatap.github.io/img/react/react1.jpeg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://wangguangatap.github.io/2020/01/27/React-Navigation/"><link rel="prev" title="Gin框架手册" href="https://wangguangatap.github.io/2020/01/27/gin%20web%E6%A1%86%E6%9E%B6%E6%89%8B%E5%86%8C/"><link rel="next" title="MySQL优化" href="https://wangguangatap.github.io/2020/01/27/MySQL%E4%BC%98%E5%8C%96/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 5.4.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">星脉</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">76</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">30</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">12</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc_mobile_items-text">1.基本原理</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-1-%E5%AE%89%E8%A3%85"><span class="toc_mobile_items-text">1.1 安装</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-2-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%88%B0Expo%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE"><span class="toc_mobile_items-text">1.2 安装依赖到Expo管理项目</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-3-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%88%B0%E5%8E%9F%E7%94%9F%E7%9A%84RN%E9%A1%B9%E7%9B%AE%E4%B8%AD"><span class="toc_mobile_items-text">1.3 安装依赖到原生的RN项目中</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#1-4-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc_mobile_items-text">1.4 遇到的问题</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#2-Hello-React-Navigation"><span class="toc_mobile_items-text">2.Hello React Navigation</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-1-%E5%AE%89%E8%A3%85%E5%A0%86%E6%A0%88%E5%AF%BC%E8%88%AA%E5%99%A8%E5%BA%93"><span class="toc_mobile_items-text">2.1 安装堆栈导航器库</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-2-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A0%86%E6%A0%88%E5%AF%BC%E8%88%AA%E5%99%A8"><span class="toc_mobile_items-text">2.2 创建一个堆栈导航器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-3-%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%88%AA%E5%99%A8"><span class="toc_mobile_items-text">2.3 配置导航器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-4-%E6%8C%87%E5%AE%9Aoptions"><span class="toc_mobile_items-text">2.4 指定options</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-5-%E4%BC%A0%E9%80%92props"><span class="toc_mobile_items-text">2.5 传递props</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-6-%E4%B8%8B%E4%B8%80%E6%AD%A5%EF%BC%9F"><span class="toc_mobile_items-text">2.6 下一步？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#2-7-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">2.7 总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#3-%E5%B1%8F%E5%B9%95%E9%A1%B5%E9%9D%A2%E5%88%87%E6%8D%A2"><span class="toc_mobile_items-text">3. 屏幕页面切换</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-1-%E5%AF%BC%E8%88%AA%E5%88%B0%E6%96%B0%E9%A1%B5%E9%9D%A2"><span class="toc_mobile_items-text">3.1 导航到新页面</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-2-%E8%BF%94%E5%9B%9E"><span class="toc_mobile_items-text">3.2 返回</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#3-3-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">3.3 总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#4-%E8%B7%AF%E7%94%B1%E9%97%B4%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc_mobile_items-text">4 路由间传递参数</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-1-%E6%9B%B4%E6%96%B0%E5%8F%82%E6%95%B0"><span class="toc_mobile_items-text">4.1 更新参数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-2-%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E5%88%B0%E4%B9%8B%E5%89%8D%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc_mobile_items-text">4.2 传递参数到之前的页面</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-3-%E5%B5%8C%E5%A5%97%E7%9A%84%E5%AF%BC%E8%88%AA%E9%A1%B5%E9%9D%A2%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc_mobile_items-text">4.3 嵌套的导航页面传递参数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#4-4-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">4.4 总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#5-%E9%85%8D%E7%BD%AEHeader-bar"><span class="toc_mobile_items-text">5. 配置Header bar</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-1-%E8%AE%BE%E7%BD%AEheader%E6%A0%87%E9%A2%98"><span class="toc_mobile_items-text">5.1 设置header标题</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-2-%E5%9C%A8title%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc_mobile_items-text">5.2 在title中使用参数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-3-%E7%94%A8setOptions%E6%9B%B4%E6%96%B0options"><span class="toc_mobile_items-text">5.3 用setOptions更新options</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-4-%E8%B0%83%E6%95%B4header%E6%A0%B7%E5%BC%8F"><span class="toc_mobile_items-text">5.4 调整header样式</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-5-%E9%A1%B5%E9%9D%A2%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%ABoptions"><span class="toc_mobile_items-text">5.5 页面之间共享options</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-6-%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E4%BB%A3%E6%9B%BF%E6%A0%87%E9%A2%98"><span class="toc_mobile_items-text">5.6 用自定义组件代替标题</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-7-%E9%A2%9D%E5%A4%96%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc_mobile_items-text">5.7 额外的配置</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#5-8-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">5.8 总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#6-Header-buttons"><span class="toc_mobile_items-text">6. Header buttons</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-1-%E5%9C%A8header%E4%B8%8A%E6%B7%BB%E5%8A%A0button"><span class="toc_mobile_items-text">6.1 在header上添加button</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-2-Header%E4%B8%8E%E9%A1%B5%E9%9D%A2%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BA%A4%E4%BA%92"><span class="toc_mobile_items-text">6.2  Header与页面组件的交互</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE"><span class="toc_mobile_items-text">6.3 自定义返回按钮</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-4-%E9%87%8D%E5%86%99%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE"><span class="toc_mobile_items-text">6.4  重写返回按钮</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#6-5-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">6.5  总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#7-%E5%B5%8C%E5%A5%97%E7%9A%84%E5%AF%BC%E8%88%AA"><span class="toc_mobile_items-text">7 嵌套的导航</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#7-1-%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E6%9C%89%E4%BB%80%E4%B9%88%E5%BD%B1%E5%93%8D"><span class="toc_mobile_items-text">7.1 嵌套导航有什么影响</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-1-1-%E6%AF%8F%E4%B8%AA%E5%AF%BC%E8%88%AA%E5%99%A8%E4%BF%9D%E5%AD%98%E8%87%AA%E5%B7%B1%E7%9A%84%E5%AF%BC%E8%88%AA%E5%8E%86%E5%8F%B2"><span class="toc_mobile_items-text">7.1.1 每个导航器保存自己的导航历史</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-1-2-%E5%AF%BC%E8%88%AA%E6%93%8D%E4%BD%9C%E7%94%B1%E5%BD%93%E5%89%8D%E5%AF%BC%E8%88%AA%E5%99%A8%E5%A4%84%E7%90%86%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E5%B0%B1%E7%94%B1%E5%AE%83%E7%9A%84%E7%88%B6%E5%AF%BC%E8%88%AA%E5%A4%84%E7%90%86"><span class="toc_mobile_items-text">7.1.2 导航操作由当前导航器处理，如果无法处理就由它的父导航处理</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-1-3-%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E4%B8%8D%E6%8E%A5%E6%94%B6%E7%88%B6%E4%BA%8B%E4%BB%B6"><span class="toc_mobile_items-text">7.1.3  嵌套导航不接收父事件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-1-4-%E7%88%B6%E5%AF%BC%E8%88%AA%E7%9A%84UI%E6%B8%B2%E6%9F%93%E5%9C%A8%E5%AD%90%E5%AF%BC%E8%88%AA%E7%9A%84%E9%A1%B6%E9%83%A8"><span class="toc_mobile_items-text">7.1.4 父导航的UI渲染在子导航的顶部</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#7-2-%E5%AF%BC%E8%88%AA%E5%88%B0%E4%B8%80%E4%B8%AA%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E9%87%8C%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc_mobile_items-text">7.2 导航到一个嵌套导航里的页面</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-2-1-%E5%9C%A8%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E5%88%B0%E9%A1%B5%E9%9D%A2"><span class="toc_mobile_items-text">7.2.1 在嵌套导航传递参数到页面</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#7-2-2-%E5%9C%A8%E5%AF%BC%E8%88%AA%E5%99%A8%E9%87%8C%E6%B8%B2%E6%9F%93%E8%A2%AB%E5%AE%9A%E4%B9%89%E7%9A%84%E5%88%9D%E5%A7%8B%E8%B7%AF%E7%94%B1"><span class="toc_mobile_items-text">7.2.2 在导航器里渲染被定义的初始路由</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#7-3-%E5%B5%8C%E5%A5%97%E6%97%B6%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc_mobile_items-text">7.3 嵌套时的最佳实践</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#8-Navigation%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc_mobile_items-text">8 Navigation生命周期</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#8-1-%E7%A4%BA%E4%BE%8B%E5%9C%BA%E6%99%AF"><span class="toc_mobile_items-text">8.1 示例场景</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#8-2-React-Navigation-%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%BA%8B%E4%BB%B6"><span class="toc_mobile_items-text">8.2 React Navigation 的生命周期事件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#8-3-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">8.3 总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#9-%E6%89%93%E5%BC%80full-screen%E6%A8%A1%E6%80%81"><span class="toc_mobile_items-text">9 打开full-screen模态</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#9-1-%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%80%81%E6%A0%88"><span class="toc_mobile_items-text">9.1 创建模态栈</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#9-2-%E6%80%BB%E7%BB%93"><span class="toc_mobile_items-text">9.2 总结</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#10-%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD"><span class="toc_mobile_items-text">10 专业术语</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-1-Header"><span class="toc_mobile_items-text">10.1 Header</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-2-Navigator"><span class="toc_mobile_items-text">10.2 Navigator</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-3-Screen-component"><span class="toc_mobile_items-text">10.3 Screen component</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-3-Navigation-Prop"><span class="toc_mobile_items-text">10.3 Navigation Prop</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-4-Route-prop"><span class="toc_mobile_items-text">10.4 Route prop</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-5-Navigation-State"><span class="toc_mobile_items-text">10.5 Navigation State</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#10-6-Route"><span class="toc_mobile_items-text">10.6 Route</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#11-%E5%85%BC%E5%AE%B9%E5%B1%82"><span class="toc_mobile_items-text">11 兼容层</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#11-1-%E5%AE%83%E5%A4%84%E7%90%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc_mobile_items-text">11.1 它处理什么？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#11-2-%E5%AE%83%E4%B8%8D%E5%A4%84%E7%90%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc_mobile_items-text">11.2 它不处理什么？</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E5%BA%94%E8%AF%A5%E4%BD%BF%E7%94%A8%E5%AE%83%EF%BC%9F"><span class="toc_mobile_items-text">为什么我们应该使用它？</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#12-%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><span class="toc_mobile_items-text">12 故障排除</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-1-%E6%9B%B4%E6%96%B0%E4%BA%86%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9CUnable-to-resolve-module%E2%80%9D%E9%94%99%E8%AF%AF"><span class="toc_mobile_items-text">12.1 更新了最新版本，得到“Unable to resolve module”错误</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-2-%E7%BC%BA%E5%B0%91%E5%AF%B9%E7%AD%89%E4%BE%9D%E8%B5%96"><span class="toc_mobile_items-text">12.2 缺少对等依赖</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-3-metro%E9%85%8D%E7%BD%AE%E4%B8%AD%E7%BC%BA%E5%B0%91%E6%89%A9%E5%B1%95"><span class="toc_mobile_items-text">12.3 metro配置中缺少扩展</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-4-%E6%8A%A5%E9%94%99%E2%80%9CSyntaxError-in-react-navigation-xxx-xxx-tsx%E2%80%9D%E6%88%96%E2%80%9CSyntaxError-xxx-react-navigation-xxx-xxx-tsx-Unexpected-token%E2%80%9D"><span class="toc_mobile_items-text">12.4 报错“SyntaxError in @react-navigation&#x2F;xxx&#x2F;xxx.tsx”或“SyntaxError: &#x2F;xxx&#x2F;@react-navigation&#x2F;xxx&#x2F;xxx.tsx: Unexpected token”</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-5-%E6%8A%A5%E9%94%99%E2%80%9CModule-%E2%80%98-%E2%80%A6-%E2%80%99-has-no-exported-member-%E2%80%98xxx%E2%80%99-when-using-TypeScript%E2%80%9D"><span class="toc_mobile_items-text">12.5 报错“Module ‘[…]’ has no exported member ‘xxx’ when using TypeScript”</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-6-%E6%8A%A5%E9%94%99%E2%80%9Cnull-is-not-an-object-evaluating-%E2%80%98RNGestureHandlerModule-default-Direction%E2%80%99-%E2%80%9D"><span class="toc_mobile_items-text">12.6 报错“null is not an object (evaluating ‘RNGestureHandlerModule.default.Direction’)”</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-7-%E6%B7%BB%E5%8A%A0%E8%A7%86%E5%9B%BE%E5%90%8E%EF%BC%8C%E5%B1%8F%E5%B9%95%E4%B8%8A%E7%9C%8B%E4%B8%8D%E5%88%B0%E4%BB%BB%E4%BD%95%E5%86%85%E5%AE%B9"><span class="toc_mobile_items-text">12.7 添加视图后，屏幕上看不到任何内容</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-8-%E8%AD%A6%E5%91%8A%EF%BC%9A%E2%80%9CNon-serializable-values-were-found-in-the-navigation-state%E2%80%9D"><span class="toc_mobile_items-text">12.8 警告：“Non-serializable values were found in the navigation state”</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#12-9-%E8%BF%9E%E6%8E%A5%E5%88%B0Chrome%E8%B0%83%E8%AF%95%E5%99%A8%E5%90%8E%EF%BC%8C%E5%BA%94%E7%94%A8%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E8%BF%90%E8%A1%8C"><span class="toc_mobile_items-text">12.9 连接到Chrome调试器后，应用无法正常运行</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#13-%E5%B1%80%E9%99%90%E6%80%A7"><span class="toc_mobile_items-text">13 局限性</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#13-1-%E6%9C%89%E9%99%90%E7%9A%84%E4%BB%8E%E5%8F%B3%E5%88%B0%E5%B7%A6%EF%BC%88RTL%EF%BC%89%E5%B8%83%E5%B1%80%E6%94%AF%E6%8C%81"><span class="toc_mobile_items-text">13.1 有限的从右到左（RTL）布局支持</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#13-2-%E4%B8%80%E4%BA%9B%E7%89%B9%E5%AE%9A%E4%BA%8E%E5%B9%B3%E5%8F%B0%E7%9A%84%E8%A1%8C%E4%B8%BA"><span class="toc_mobile_items-text">13.2 一些特定于平台的行为</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#1-%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86"><span class="toc-text">1.基本原理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1-%E5%AE%89%E8%A3%85"><span class="toc-text">1.1 安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%88%B0Expo%E7%AE%A1%E7%90%86%E9%A1%B9%E7%9B%AE"><span class="toc-text">1.2 安装依赖到Expo管理项目</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3-%E5%AE%89%E8%A3%85%E4%BE%9D%E8%B5%96%E5%88%B0%E5%8E%9F%E7%94%9F%E7%9A%84RN%E9%A1%B9%E7%9B%AE%E4%B8%AD"><span class="toc-text">1.3 安装依赖到原生的RN项目中</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">1.4 遇到的问题</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#2-Hello-React-Navigation"><span class="toc-text">2.Hello React Navigation</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1-%E5%AE%89%E8%A3%85%E5%A0%86%E6%A0%88%E5%AF%BC%E8%88%AA%E5%99%A8%E5%BA%93"><span class="toc-text">2.1 安装堆栈导航器库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2-%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%A0%86%E6%A0%88%E5%AF%BC%E8%88%AA%E5%99%A8"><span class="toc-text">2.2 创建一个堆栈导航器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-3-%E9%85%8D%E7%BD%AE%E5%AF%BC%E8%88%AA%E5%99%A8"><span class="toc-text">2.3 配置导航器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-4-%E6%8C%87%E5%AE%9Aoptions"><span class="toc-text">2.4 指定options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-5-%E4%BC%A0%E9%80%92props"><span class="toc-text">2.5 传递props</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-6-%E4%B8%8B%E4%B8%80%E6%AD%A5%EF%BC%9F"><span class="toc-text">2.6 下一步？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-7-%E6%80%BB%E7%BB%93"><span class="toc-text">2.7 总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#3-%E5%B1%8F%E5%B9%95%E9%A1%B5%E9%9D%A2%E5%88%87%E6%8D%A2"><span class="toc-text">3. 屏幕页面切换</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1-%E5%AF%BC%E8%88%AA%E5%88%B0%E6%96%B0%E9%A1%B5%E9%9D%A2"><span class="toc-text">3.1 导航到新页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E8%BF%94%E5%9B%9E"><span class="toc-text">3.2 返回</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E6%80%BB%E7%BB%93"><span class="toc-text">3.3 总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#4-%E8%B7%AF%E7%94%B1%E9%97%B4%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc-text">4 路由间传递参数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-%E6%9B%B4%E6%96%B0%E5%8F%82%E6%95%B0"><span class="toc-text">4.1 更新参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E5%88%B0%E4%B9%8B%E5%89%8D%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-text">4.2 传递参数到之前的页面</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-%E5%B5%8C%E5%A5%97%E7%9A%84%E5%AF%BC%E8%88%AA%E9%A1%B5%E9%9D%A2%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0"><span class="toc-text">4.3 嵌套的导航页面传递参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-%E6%80%BB%E7%BB%93"><span class="toc-text">4.4 总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#5-%E9%85%8D%E7%BD%AEHeader-bar"><span class="toc-text">5. 配置Header bar</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1-%E8%AE%BE%E7%BD%AEheader%E6%A0%87%E9%A2%98"><span class="toc-text">5.1 设置header标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2-%E5%9C%A8title%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%82%E6%95%B0"><span class="toc-text">5.2 在title中使用参数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3-%E7%94%A8setOptions%E6%9B%B4%E6%96%B0options"><span class="toc-text">5.3 用setOptions更新options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-4-%E8%B0%83%E6%95%B4header%E6%A0%B7%E5%BC%8F"><span class="toc-text">5.4 调整header样式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-5-%E9%A1%B5%E9%9D%A2%E4%B9%8B%E9%97%B4%E5%85%B1%E4%BA%ABoptions"><span class="toc-text">5.5 页面之间共享options</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-6-%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%BB%84%E4%BB%B6%E4%BB%A3%E6%9B%BF%E6%A0%87%E9%A2%98"><span class="toc-text">5.6 用自定义组件代替标题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-7-%E9%A2%9D%E5%A4%96%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="toc-text">5.7 额外的配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-8-%E6%80%BB%E7%BB%93"><span class="toc-text">5.8 总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#6-Header-buttons"><span class="toc-text">6. Header buttons</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1-%E5%9C%A8header%E4%B8%8A%E6%B7%BB%E5%8A%A0button"><span class="toc-text">6.1 在header上添加button</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2-Header%E4%B8%8E%E9%A1%B5%E9%9D%A2%E7%BB%84%E4%BB%B6%E7%9A%84%E4%BA%A4%E4%BA%92"><span class="toc-text">6.2  Header与页面组件的交互</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-3-%E8%87%AA%E5%AE%9A%E4%B9%89%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE"><span class="toc-text">6.3 自定义返回按钮</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-4-%E9%87%8D%E5%86%99%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE"><span class="toc-text">6.4  重写返回按钮</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-5-%E6%80%BB%E7%BB%93"><span class="toc-text">6.5  总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#7-%E5%B5%8C%E5%A5%97%E7%9A%84%E5%AF%BC%E8%88%AA"><span class="toc-text">7 嵌套的导航</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1-%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E6%9C%89%E4%BB%80%E4%B9%88%E5%BD%B1%E5%93%8D"><span class="toc-text">7.1 嵌套导航有什么影响</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-1-%E6%AF%8F%E4%B8%AA%E5%AF%BC%E8%88%AA%E5%99%A8%E4%BF%9D%E5%AD%98%E8%87%AA%E5%B7%B1%E7%9A%84%E5%AF%BC%E8%88%AA%E5%8E%86%E5%8F%B2"><span class="toc-text">7.1.1 每个导航器保存自己的导航历史</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-2-%E5%AF%BC%E8%88%AA%E6%93%8D%E4%BD%9C%E7%94%B1%E5%BD%93%E5%89%8D%E5%AF%BC%E8%88%AA%E5%99%A8%E5%A4%84%E7%90%86%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%97%A0%E6%B3%95%E5%A4%84%E7%90%86%E5%B0%B1%E7%94%B1%E5%AE%83%E7%9A%84%E7%88%B6%E5%AF%BC%E8%88%AA%E5%A4%84%E7%90%86"><span class="toc-text">7.1.2 导航操作由当前导航器处理，如果无法处理就由它的父导航处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-3-%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E4%B8%8D%E6%8E%A5%E6%94%B6%E7%88%B6%E4%BA%8B%E4%BB%B6"><span class="toc-text">7.1.3  嵌套导航不接收父事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-4-%E7%88%B6%E5%AF%BC%E8%88%AA%E7%9A%84UI%E6%B8%B2%E6%9F%93%E5%9C%A8%E5%AD%90%E5%AF%BC%E8%88%AA%E7%9A%84%E9%A1%B6%E9%83%A8"><span class="toc-text">7.1.4 父导航的UI渲染在子导航的顶部</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2-%E5%AF%BC%E8%88%AA%E5%88%B0%E4%B8%80%E4%B8%AA%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E9%87%8C%E7%9A%84%E9%A1%B5%E9%9D%A2"><span class="toc-text">7.2 导航到一个嵌套导航里的页面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-1-%E5%9C%A8%E5%B5%8C%E5%A5%97%E5%AF%BC%E8%88%AA%E4%BC%A0%E9%80%92%E5%8F%82%E6%95%B0%E5%88%B0%E9%A1%B5%E9%9D%A2"><span class="toc-text">7.2.1 在嵌套导航传递参数到页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-2-%E5%9C%A8%E5%AF%BC%E8%88%AA%E5%99%A8%E9%87%8C%E6%B8%B2%E6%9F%93%E8%A2%AB%E5%AE%9A%E4%B9%89%E7%9A%84%E5%88%9D%E5%A7%8B%E8%B7%AF%E7%94%B1"><span class="toc-text">7.2.2 在导航器里渲染被定义的初始路由</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3-%E5%B5%8C%E5%A5%97%E6%97%B6%E7%9A%84%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-text">7.3 嵌套时的最佳实践</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#8-Navigation%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-text">8 Navigation生命周期</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1-%E7%A4%BA%E4%BE%8B%E5%9C%BA%E6%99%AF"><span class="toc-text">8.1 示例场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2-React-Navigation-%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E4%BA%8B%E4%BB%B6"><span class="toc-text">8.2 React Navigation 的生命周期事件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-3-%E6%80%BB%E7%BB%93"><span class="toc-text">8.3 总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-%E6%89%93%E5%BC%80full-screen%E6%A8%A1%E6%80%81"><span class="toc-text">9 打开full-screen模态</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#9-1-%E5%88%9B%E5%BB%BA%E6%A8%A1%E6%80%81%E6%A0%88"><span class="toc-text">9.1 创建模态栈</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-2-%E6%80%BB%E7%BB%93"><span class="toc-text">9.2 总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#10-%E4%B8%93%E4%B8%9A%E6%9C%AF%E8%AF%AD"><span class="toc-text">10 专业术语</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#10-1-Header"><span class="toc-text">10.1 Header</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-2-Navigator"><span class="toc-text">10.2 Navigator</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-Screen-component"><span class="toc-text">10.3 Screen component</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-3-Navigation-Prop"><span class="toc-text">10.3 Navigation Prop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-4-Route-prop"><span class="toc-text">10.4 Route prop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-5-Navigation-State"><span class="toc-text">10.5 Navigation State</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-6-Route"><span class="toc-text">10.6 Route</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#11-%E5%85%BC%E5%AE%B9%E5%B1%82"><span class="toc-text">11 兼容层</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#11-1-%E5%AE%83%E5%A4%84%E7%90%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">11.1 它处理什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-2-%E5%AE%83%E4%B8%8D%E5%A4%84%E7%90%86%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">11.2 它不处理什么？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BA%E4%BB%80%E4%B9%88%E6%88%91%E4%BB%AC%E5%BA%94%E8%AF%A5%E4%BD%BF%E7%94%A8%E5%AE%83%EF%BC%9F"><span class="toc-text">为什么我们应该使用它？</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#12-%E6%95%85%E9%9A%9C%E6%8E%92%E9%99%A4"><span class="toc-text">12 故障排除</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#12-1-%E6%9B%B4%E6%96%B0%E4%BA%86%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%EF%BC%8C%E5%BE%97%E5%88%B0%E2%80%9CUnable-to-resolve-module%E2%80%9D%E9%94%99%E8%AF%AF"><span class="toc-text">12.1 更新了最新版本，得到“Unable to resolve module”错误</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-2-%E7%BC%BA%E5%B0%91%E5%AF%B9%E7%AD%89%E4%BE%9D%E8%B5%96"><span class="toc-text">12.2 缺少对等依赖</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-3-metro%E9%85%8D%E7%BD%AE%E4%B8%AD%E7%BC%BA%E5%B0%91%E6%89%A9%E5%B1%95"><span class="toc-text">12.3 metro配置中缺少扩展</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-4-%E6%8A%A5%E9%94%99%E2%80%9CSyntaxError-in-react-navigation-xxx-xxx-tsx%E2%80%9D%E6%88%96%E2%80%9CSyntaxError-xxx-react-navigation-xxx-xxx-tsx-Unexpected-token%E2%80%9D"><span class="toc-text">12.4 报错“SyntaxError in @react-navigation&#x2F;xxx&#x2F;xxx.tsx”或“SyntaxError: &#x2F;xxx&#x2F;@react-navigation&#x2F;xxx&#x2F;xxx.tsx: Unexpected token”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-5-%E6%8A%A5%E9%94%99%E2%80%9CModule-%E2%80%98-%E2%80%A6-%E2%80%99-has-no-exported-member-%E2%80%98xxx%E2%80%99-when-using-TypeScript%E2%80%9D"><span class="toc-text">12.5 报错“Module ‘[…]’ has no exported member ‘xxx’ when using TypeScript”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-6-%E6%8A%A5%E9%94%99%E2%80%9Cnull-is-not-an-object-evaluating-%E2%80%98RNGestureHandlerModule-default-Direction%E2%80%99-%E2%80%9D"><span class="toc-text">12.6 报错“null is not an object (evaluating ‘RNGestureHandlerModule.default.Direction’)”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-7-%E6%B7%BB%E5%8A%A0%E8%A7%86%E5%9B%BE%E5%90%8E%EF%BC%8C%E5%B1%8F%E5%B9%95%E4%B8%8A%E7%9C%8B%E4%B8%8D%E5%88%B0%E4%BB%BB%E4%BD%95%E5%86%85%E5%AE%B9"><span class="toc-text">12.7 添加视图后，屏幕上看不到任何内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-8-%E8%AD%A6%E5%91%8A%EF%BC%9A%E2%80%9CNon-serializable-values-were-found-in-the-navigation-state%E2%80%9D"><span class="toc-text">12.8 警告：“Non-serializable values were found in the navigation state”</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-9-%E8%BF%9E%E6%8E%A5%E5%88%B0Chrome%E8%B0%83%E8%AF%95%E5%99%A8%E5%90%8E%EF%BC%8C%E5%BA%94%E7%94%A8%E6%97%A0%E6%B3%95%E6%AD%A3%E5%B8%B8%E8%BF%90%E8%A1%8C"><span class="toc-text">12.9 连接到Chrome调试器后，应用无法正常运行</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#13-%E5%B1%80%E9%99%90%E6%80%A7"><span class="toc-text">13 局限性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#13-1-%E6%9C%89%E9%99%90%E7%9A%84%E4%BB%8E%E5%8F%B3%E5%88%B0%E5%B7%A6%EF%BC%88RTL%EF%BC%89%E5%B8%83%E5%B1%80%E6%94%AF%E6%8C%81"><span class="toc-text">13.1 有限的从右到左（RTL）布局支持</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-2-%E4%B8%80%E4%BA%9B%E7%89%B9%E5%AE%9A%E4%BA%8E%E5%B9%B3%E5%8F%B0%E7%9A%84%E8%A1%8C%E4%B8%BA"><span class="toc-text">13.2 一些特定于平台的行为</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/react/react.jpeg)"><div id="post-info"><div id="post-title"><div class="posttitle">React Native</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-01-27<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-07-25</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/React/">React</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="1-基本原理"><a href="#1-基本原理" class="headerlink" title="1.基本原理"></a>1.基本原理</h1><h2 id="1-1-安装"><a href="#1-1-安装" class="headerlink" title="1.1 安装"></a>1.1 安装</h2><p>在RN项目中安装您需要的包</p>
<ul>
<li>npm<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @react-navigation&#x2F;native</span><br></pre></td></tr></table></figure></div></li>
<li>yarn<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @react-navigation&#x2F;native</span><br></pre></td></tr></table></figure></div>
React导航由一些核心工具组成，并且导航器使用这些工具在应用中创建导航结构。为了提前加载安装工作，我们还需要安装和配置大多数导航器使用的依赖项，然后我们开始编写代码。</li>
</ul>
<p>现在，我们需要安装react-native-gesture-handler、 react-native-reanimated、react-native-screens 、 react-native-safe-area-context、 @react-native-community/masked-view这些库，如果您已经安装了这些最新版本的库，那可以跳过下面内容，否则继续阅读下去。</p>
<h2 id="1-2-安装依赖到Expo管理项目"><a href="#1-2-安装依赖到Expo管理项目" class="headerlink" title="1.2 安装依赖到Expo管理项目"></a>1.2 安装依赖到Expo管理项目</h2><p>cd到你的项目目录下，运行：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expo install react-native-gesture-handler react-native-reanimated react-native-screens react-native-safe-area-context @react-native-community&#x2F;masked-view</span><br></pre></td></tr></table></figure></div>
<p>这个命令会安装这些库的最合适的版本。接下来，您可以继续到项目中编写代码。<br>(注：用Expo管理项目，目前还没用到过，有疑问的童鞋麻烦自行查询！)</p>
<h2 id="1-3-安装依赖到原生的RN项目中"><a href="#1-3-安装依赖到原生的RN项目中" class="headerlink" title="1.3 安装依赖到原生的RN项目中"></a>1.3 安装依赖到原生的RN项目中</h2><p>cd到你的项目目录下，运行：</p>
<ul>
<li>npm<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install react-native-reanimated react-native-gesture-handler react-native-screens react-native-safe-area-context @react-native-community&#x2F;masked-view</span><br></pre></td></tr></table></figure></div></li>
<li>yarn<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add react-native-reanimated react-native-gesture-handler react-native-screens react-native-safe-area-context @react-native-community&#x2F;masked-view</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>注意：安装后可能会出现有相关的对等依赖的警告，这个通常是由于一些不同版本的包引起的，只要您的项目可以顺利运行，可以忽略这些警告。</p>
</blockquote>
</li>
</ul>
<p>从RN 0.60或者更高版本开始，这些库会自动链接项目，因此不需要运行react-native link。</p>
<p>如果您是在mac上开发iOS项目，需要安装CocoaPods来完成项目链接：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx pod-install ios</span><br></pre></td></tr></table></figure></div>
<p>当您完成了react-native-gesture-handler的安装，在项目的入口文件（例如index.js或App.js）引入react-native-gesture-handler（确保在入口文件的第一行）</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import &#39;react-native-gesture-handler&#39;;</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>注意：如果您忽略这一步，尽管在开发中运行是正常的，但在生产上将会奔溃。</p>
</blockquote>
<p>现在，我们需要将整个app装载在NavigationContainer之中。通常做法是，在入口文件（例如index.js或App.js）做这些事情：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import &#39;react-native-gesture-handler&#39;;</span><br><span class="line">import * as React from &#39;react&#39;;</span><br><span class="line">import &#123; NavigationContainer &#125; from &#39;@react-navigation&#x2F;native&#39;;</span><br><span class="line"></span><br><span class="line">export default function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;NavigationContainer&gt;&#123;&#x2F;* Rest of your app code *&#x2F;&#125;&lt;&#x2F;NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<blockquote>
<p>注意：当您使用导航器(如堆栈导航器)时，对于任何其他依赖项，都需要遵循导航器的安装说明。如果您遇到”Unable to resolve module”的错误，您需要安装错误中提示的组件到项目中。</p>
</blockquote>
<p>现在，您可以将项目编译并运行在设备或者模拟器上，并继续进行相关的代码编写。</p>
<h2 id="1-4-遇到的问题"><a href="#1-4-遇到的问题" class="headerlink" title="1.4 遇到的问题"></a>1.4 遇到的问题</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">报错：TypeError: null is not an object (evaluating &#39;_RNGestureHandlerModule.default.Direction&#39;)</span><br></pre></td></tr></table></figure></div>
<p>解决方法：<br>在ios文件夹下的Podfile文件中添加：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pod &#39;RNGestureHandler&#39;, :path &#x3D;&gt; &quot;..&#x2F;node_modules&#x2F;react-native-gesture-handler&quot;</span><br></pre></td></tr></table></figure></div>

<p>终端命令cd到ios文件，运行pod install</p>
<h1 id="2-Hello-React-Navigation"><a href="#2-Hello-React-Navigation" class="headerlink" title="2.Hello React Navigation"></a>2.Hello React Navigation</h1><p>在web浏览器上，您可能会用一个<code>&lt;a&gt;</code>标签链接到另一个页面上。当用户点击了一个链接，URL被推到浏览器历史堆栈中，当用户点击了返回按钮，浏览器会从历史堆栈中弹出之前的访问过的页面作为目前展示的页面。React Native不像web浏览器那样有内置的全局历史堆栈概念——这就是React导航的作用。</p>
<p>React Navigation的堆栈导航器为应用程序提供了在屏幕之间转换和管理导航历史的方法。如果您的应用程序只使用一个堆栈导航器，那么它在概念上类似于web浏览器处理导航状态——当用户与它交互时，您的应用程序从导航堆栈中推送和弹出项目，用户可以看到不同的页面。它在web浏览器和React导航中的工作方式的一个关键区别是，React导航的堆栈导航器提供了在Android和iOS中导航堆栈中的路由时需要的手势和动画。</p>
<p>让我们从演示最常见的导航器开始，createStackNavigator。</p>
<h2 id="2-1-安装堆栈导航器库"><a href="#2-1-安装堆栈导航器库" class="headerlink" title="2.1 安装堆栈导航器库"></a>2.1 安装堆栈导航器库</h2><p>到目前为止，我们安装是导航器的构建块和共享基础的库，React Navigation中的每个导航器都在自己的库中。要使用堆栈导航器，我们需要安装@ response -navigation/stack:</p>
<ul>
<li>npm<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @react-navigation&#x2F;stack</span><br></pre></td></tr></table></figure></div></li>
<li>yarn<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @react-navigation&#x2F;stack</span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>提醒：@react-navigation/stack 依赖于我们在开始章节安装的库 @react-native-community/masked-view，如果您还未安装，麻烦回到上一章节。</p>
</blockquote>
</li>
</ul>
<h2 id="2-2-创建一个堆栈导航器"><a href="#2-2-创建一个堆栈导航器" class="headerlink" title="2.2 创建一个堆栈导航器"></a>2.2 创建一个堆栈导航器</h2><p>createStackNavigator是一个函数，它返回一个包含两个属性的对象:屏幕和导航器。它们都是用于配置导航器的React组件。导航器应该将屏幕元素作为子元素来定义路由的配置。</p>
<p>NavigationContainer是一个管理导航树并包含导航状态的组件。该组件必须包装所有导航器结构。通常，我们会将这个组件呈现在应用程序的根目录下，这个根目录通常是从app .js导出的组件。这里我自定义了一个路由文件，然后在app.js中引入：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//自定义一个路由文件NavigationComponent.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Text, View&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;NavigationContainer&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createStackNavigator&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/stack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params">&#123;navigation&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123;<span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Home Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Stack = createStackNavigator();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NavigationComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NavigationContainer&gt;</span><br><span class="line">      &lt;Stack.Navigator initialRouteName=<span class="string">"Home"</span>&gt;</span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Home"</span> component=&#123;HomeScreen&#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> NavigationComponent;</span><br></pre></td></tr></table></figure></div>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//在App.js中引入</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'react-native-gesture-handler'</span>;</span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> NavigationComponent <span class="keyword">from</span> <span class="string">'./Sections/常用组件/NavigationComponent'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">NavigationComponent</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p><a href="/img/react/screen.png" data-fancybox="group" data-caption="avatar" class="fancybox"><img alt="avatar" title="avatar" data-src="/img/react/screen.png" class="lazyload"></a></p>
<p>如果您运行这段代码，您将看到一个带有空导航栏和包含主屏幕组件的灰色内容区域的屏幕(如上所示)。您看到的导航栏和内容区域的样式是堆栈导航器的默认配置，稍后我们将学习如何配置它们。</p>
<blockquote>
<p>路由名称的对大小写不敏感——您可以使用小写的home或大写的home，这取决于您。我们喜欢把路线名称大写。</p>
</blockquote>
<blockquote>
<p>屏幕唯一需要的配置是name和component props。您可以在stack navigator reference中了解更多其他可用选项的信息。</p>
</blockquote>
<h2 id="2-3-配置导航器"><a href="#2-3-配置导航器" class="headerlink" title="2.3 配置导航器"></a>2.3 配置导航器</h2><p>所有路由配置都被指定为导航器的props。我们没有向导航器传递任何props，因此它只使用默认配置。</p>
<p>让我们在堆栈导航器中添加第二个屏幕，并配置主屏幕首先渲染:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DetailsScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Details Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Stack = createStackNavigator();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NavigationComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NavigationContainer&gt;</span><br><span class="line">      &lt;Stack.Navigator initialRouteName=<span class="string">"Home"</span>&gt;</span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Home"</span> component=&#123;HomeScreen&#125; /&gt;</span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Details"</span> component=&#123;DetailsScreen&#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>现在我们的堆栈有两个路由页面，一个主页面和一个详细页面。可以使用Screen组件指定路由。屏幕组件接受一个name prop，对应于导航的路由的名称，以及一个component prop，对应于它将渲染的组件。</p>
<p>这里，主路由对应于HomeScreen组件，而详细信息路由对应于DetailsScreen组件。堆栈的初始路由是主路由。尝试将其更改为Details并重新加载应用程序(如您所料，React Native的快速刷新不会更新initialRouteName的更改)，注意您现在将看到Details屏幕。然后将其更改为Home并重新加载一次。</p>
<blockquote>
<p><code>注意:组件prop只接受component，而不是渲染函数。不要传递内联函数(例如component={() =&gt; &lt;HomeScreen /&gt;})，否则当父组件重新渲染时，你的组件将会卸载和重新加载并移除所有的state。见Passing additional props来替代。</code></p>
</blockquote>
<h2 id="2-4-指定options"><a href="#2-4-指定options" class="headerlink" title="2.4 指定options"></a>2.4 指定options</h2><p>在导航器里的每个屏幕可以指定一些options，例如一个渲染页面的标题。这些options可以传递到每个屏幕组件的options prop中：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Stack.Screen</span><br><span class="line">  name=<span class="string">"Home"</span></span><br><span class="line">  component=&#123;HomeScreen&#125;</span><br><span class="line">  options=&#123;&#123; <span class="attr">title</span>: <span class="string">'Overview'</span> &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></div>
<p>有时我们希望为导航器中的所有屏幕指定相同的options。为此，我们可以向导航器传递screenOptions prop。</p>
<h2 id="2-5-传递props"><a href="#2-5-传递props" class="headerlink" title="2.5 传递props"></a>2.5 传递props</h2><p>有时我们可能想要传递props到屏幕上。我们可以用两种方法来实现:</p>
<p>1.使用React context提供程序包装导航器，以便向屏幕传递数据(推荐)。</p>
<p>2.使用屏幕渲染回调来代替指定一个组件的prop:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;Stack.Screen name=<span class="string">"Home"</span>&gt;</span><br><span class="line">  &#123;props =&gt; <span class="xml"><span class="tag">&lt;<span class="name">HomeScreen</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">extraData</span>=<span class="string">&#123;someData&#125;</span> /&gt;</span></span>&#125;</span><br><span class="line">&lt;<span class="regexp">/Stack.Screen&gt;</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>注意:默认情况下，React Navigation会对屏幕组件进行优化，以防止不必要的渲染。使用渲染回调会移除这些优化。所以如果你使用渲染回调，需要为组件使用React.memo或React.PureComponent，以避免性能问题。</p>
</blockquote>
<h2 id="2-6-下一步？"><a href="#2-6-下一步？" class="headerlink" title="2.6 下一步？"></a>2.6 下一步？</h2><p>接下来的问题是:“我如何从主页面跳转到详情页面?”，这将在下一节中介绍</p>
<h2 id="2-7-总结"><a href="#2-7-总结" class="headerlink" title="2.7 总结"></a>2.7 总结</h2><ul>
<li><p>React Native没有像web浏览器那样的内置导航API。React导航为你提供了这个功能，以及提供iOS和Android的手势和动画来在屏幕之间切换。</p>
</li>
<li><p>Stack.Navigator是一个组件，它将路由配置为子组件和用于配置props，并渲染内容。</p>
</li>
<li><p>每个Stack.Screen组件接受一个名称prop，该名称引用路由的名称，而component prop被指定为路由渲染的组件。这是2个必需的props。</p>
</li>
<li><p>要指定堆栈中的初始路由是什么，请设置initialRouteName作为导航器的prop。</p>
</li>
<li><p>要指定特定于屏幕的options，我们可以向堆栈传递一个options prop。对于常见的options，我们可以将屏幕options传递给Stack.Navigator</p>
</li>
</ul>
<h1 id="3-屏幕页面切换"><a href="#3-屏幕页面切换" class="headerlink" title="3. 屏幕页面切换"></a>3. 屏幕页面切换</h1><p>在前面的章节，我们定义了一个包含主页面和详情页面的堆栈路由，但是我们没有学习如何让用户导航主页面和详细页面(虽然我们学习了在代码中如何改变初始路由，但让用户强制克隆库和改变初始路由，以达到展示另一个页面，可以想象，这是最糟糕的用户体验)。</p>
<p>如果是web浏览器，我们可以这样：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">"details.html"</span>&gt;Go to Details&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure></div>
<p>另一个方法是：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;a</span><br><span class="line">  onClick=&#123;() =&gt; &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">'details.html'</span>;</span><br><span class="line">  &#125;&#125;</span><br><span class="line">&gt;</span><br><span class="line">  Go to Details</span><br><span class="line">&lt;<span class="regexp">/a&gt;</span></span><br></pre></td></tr></table></figure></div>

<p>我们将执行与全局window.location类似的操作，我们将使用navigation prop向下传递到屏幕组件。</p>
<h2 id="3-1-导航到新页面"><a href="#3-1-导航到新页面" class="headerlink" title="3.1 导航到新页面"></a>3.1 导航到新页面</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Button, View, Text &#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NavigationContainer &#125; <span class="keyword">from</span> <span class="string">'@react-navigation/native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; createStackNavigator &#125; <span class="keyword">from</span> <span class="string">'@react-navigation/stack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params">&#123; navigation &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Home Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Details"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; navigation.navigate('Details')&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ ... other code from the previous section</span></span><br></pre></td></tr></table></figure></div>
<p>让我们来分析一下：</p>
<ul>
<li>navigation - 在堆栈导航器中，navigation这个属性被传递到每个屏幕组件（定义）中。稍后将在”深入导航属性”中详细介绍 。</li>
<li>navigate(‘Details’) - 我们用路由的名称来调用导航函数来达到用户想要看到的页面(在导航属性上——命名是困难的!)。</li>
</ul>
<blockquote>
<p>如果我们使用navigation.navigate，导航到未在堆栈导航器上定义的路由名称，将不会发生任何事情。换句话说，我们只能导航到在堆栈导航器上定义的路由——不能导航到任意组件。<br>现在在我们的栈上有两个路由：（1）主路由，（2）详情路由。如果我们在详情页面再次导航到详情页面，会发生什么？</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DetailsScreen</span>(<span class="params">&#123; navigation &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Details Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Details... again"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; navigation.navigate('Details')&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>如果你运行这段代码，当你点击”Go to Details… again”后，不会做任何事情！因为我们已经在详情页面上了。</p>
<p>假设，我们确实想跳转到一个新的详情页面。这在向每个路由传递一些唯一数据的情况下非常常见(稍后在讨论参数时将对此进行更多讨论!)。我们可以用navigate的push来达到目的，这个允许添加一个路由而不必理会栈上是否有这个路由。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;Button</span><br><span class="line">  title=<span class="string">"Go to Details... again"</span></span><br><span class="line">  onPress=&#123;() =&gt; navigation.push(<span class="string">'Details'</span>)&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></div>
<p>每次使用push，在栈导航器上都会新增一个路由。而当使用navigate时，首先会判断是否有这个名称的路由，当栈上没有这个路由时才会跳转到一个新的路由页面。</p>
<h2 id="3-2-返回"><a href="#3-2-返回" class="headerlink" title="3.2 返回"></a>3.2 返回</h2><p>在路由中，当前页面的头部会有一个返回按钮，点击返回按钮可以回到之前的页面（但如果在路由中只有一个页面，头部没有返回按钮，也无法操作返回按钮）。<br>有时候你想通过编写代码来完成这个操作，我们使用navigation.goBack();这样做：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DetailsScreen</span>(<span class="params">&#123; navigation &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Details Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Details... again"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; navigation.push('Details')&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">      &lt;Button title=<span class="string">"Go to Home"</span> onPress=&#123;() =&gt; navigation.navigate(<span class="string">'Home'</span>)&#125; /&gt;</span><br><span class="line">      &lt;Button title=<span class="string">"Go back"</span> onPress=&#123;() =&gt; navigation.goBack()&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>在Android上，React Navigation在用户点击硬件返回按钮时，返回事件是一样的。<br>另一个常见的需求是多个页面的返回–例如，你已经跳转了多个页面，想直接回到第一个页面，在本例中，我们要返回Home，所以我们可以使用navigate(‘Home’)(而不是push!试试看，看看有什么不同)。另一种选择是navigation.popToTop()，它返回到堆栈中的第一个屏幕。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DetailsScreen</span>(<span class="params">&#123; navigation &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Details Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Details... again"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; navigation.push('Details')&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">      &lt;Button title=<span class="string">"Go to Home"</span> onPress=&#123;() =&gt; navigation.navigate(<span class="string">'Home'</span>)&#125; /&gt;</span><br><span class="line">      &lt;Button title=<span class="string">"Go back"</span> onPress=&#123;() =&gt; navigation.goBack()&#125; /&gt;</span><br><span class="line">      &lt;Button</span><br><span class="line">        title=<span class="string">"Go back to first screen in stack"</span></span><br><span class="line">        onPress=&#123;() =&gt; navigation.popToTop()&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="3-3-总结"><a href="#3-3-总结" class="headerlink" title="3.3 总结"></a>3.3 总结</h2><ul>
<li><p>navigation.navigate(‘RouteName’)如果新路由不在堆栈中，则将其推到堆栈导航器，否则将跳转到这个页面。</p>
</li>
<li><p>navigation.push(‘RouteName’)可以多次跳转同一个路由页面。</p>
</li>
<li><p>header bar会自带一个返回按钮提供返回操作，但是我们可以使用navigation.goBack()来实现返回操作。在Android上的硬件返回按钮的返回操作是一样的效果。</p>
</li>
<li><p>你能使用navigation.navigate(‘RouteName’)返回到一个已经存在的页面，并且你可以使用navigation.popToTop()返回第一个页面。</p>
</li>
<li><p>在所有的页面组件中都可以获取到navigation属性（只要组件被定义为路由配置和使用React Navigation来渲染路由）</p>
</li>
</ul>
<h1 id="4-路由间传递参数"><a href="#4-路由间传递参数" class="headerlink" title="4 路由间传递参数"></a>4 路由间传递参数</h1><p>还记得我说过”稍后在讨论参数时将对此进行更多讨论!“吗？现在可以开始了。</p>
<p>现在我们知道如何在栈导航器上创建一些路由，并且路由之间的跳转，那么如何在路由之间传递参数呢，我们来看看。</p>
<p>这里有两部分：</p>
<ol>
<li><p>将路由上需要的参数放在一个对象里，作为navigation.navigate函数的第二个参数：navigation.navigate(‘RouteName’, { /* params go here */ })</p>
</li>
<li><p>在组件中获取这个参数：route.params</p>
</li>
</ol>
<blockquote>
<p>我们推荐传递的参数是JSON格式。这样，您就能够使用状态持久性<br>，并且您的屏幕组件可以使用正确的约定来实现深度链接。</p>
</blockquote>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params">&#123; navigation &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Home Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Details"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">          /</span>* <span class="number">1.</span> Navigate to the Details route <span class="keyword">with</span> params *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">          navigation.navigate('Details', &#123;</span></span><br><span class="line"><span class="regexp">            itemId: 86,</span></span><br><span class="line"><span class="regexp">            otherParam: 'anything you want here',</span></span><br><span class="line"><span class="regexp">          &#125;);</span></span><br><span class="line"><span class="regexp">        &#125;&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function DetailsScreen(&#123; route, navigation &#125;) &#123;</span></span><br><span class="line"><span class="regexp">  /</span>* <span class="number">2.</span> Get the param *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">  const &#123; itemId &#125; = route.params;</span></span><br><span class="line"><span class="regexp">  const &#123; otherParam &#125; = route.params;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;View style=&#123;&#123; flex: 1, alignItems: 'center', justifyContent: 'center' &#125;&#125;&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Text&gt;Details Screen&lt;/</span>Text&gt;</span><br><span class="line">      &lt;Text&gt;itemId: &#123;<span class="built_in">JSON</span>.stringify(itemId)&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Text&gt;otherParam: &#123;JSON.stringify(otherParam)&#125;&lt;/</span>Text&gt;</span><br><span class="line">      &lt;Button</span><br><span class="line">        title=<span class="string">"Go to Details... again"</span></span><br><span class="line">        onPress=&#123;() =&gt;</span><br><span class="line">          navigation.push(<span class="string">'Details'</span>, &#123;</span><br><span class="line">            itemId: <span class="built_in">Math</span>.floor(<span class="built_in">Math</span>.random() * <span class="number">100</span>),</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;Button title=<span class="string">"Go to Home"</span> onPress=&#123;() =&gt; navigation.navigate(<span class="string">'Home'</span>)&#125; /&gt;</span><br><span class="line">      &lt;Button title=<span class="string">"Go back"</span> onPress=&#123;() =&gt; navigation.goBack()&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="4-1-更新参数"><a href="#4-1-更新参数" class="headerlink" title="4.1 更新参数"></a>4.1 更新参数</h2><p>页面上也可以更新参数，类似更新页面状态。navigation.setParams就可以用来更新页面参数。通过API reference for了解更多。</p>
<p>你也可以向页面传递一些初始参数。如果导航到页面并没有设置任何参数，这个初始参数将会被使用。它们会与传递的参数进行浅合并。初始参数被指定为initialParams 属性:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;Stack.Screen</span><br><span class="line">  name=<span class="string">"Details"</span></span><br><span class="line">  component=&#123;DetailsScreen&#125;</span><br><span class="line">  initialParams=&#123;&#123; <span class="attr">itemId</span>: <span class="number">42</span> &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="4-2-传递参数到之前的页面"><a href="#4-2-传递参数到之前的页面" class="headerlink" title="4.2 传递参数到之前的页面"></a>4.2 传递参数到之前的页面</h2><p>不仅仅能传递参数到新的页面，也能传递参数到之前的页面。例如，在页面上创建一个post按钮，并且点击这个按钮创建一个新的post页面。在创建了post页面以后，你想传递一些数据到上一个页面。</p>
<p>想做到这个，你可以使用navigate的方法，如果页面存在的话，可以使用像goBack这样的方法。你可以通过navigate携带参数将参数传回去：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params">&#123; navigation, route &#125;</span>) </span>&#123;</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (route.params?.post) &#123;</span><br><span class="line">      <span class="comment">// Post updated, do something with `route.params.post`</span></span><br><span class="line">      <span class="comment">// For example, send the post to the server</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, [route.params]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Button</span><br><span class="line">        title=<span class="string">"Create post"</span></span><br><span class="line">        onPress=&#123;() =&gt; navigation.navigate(<span class="string">'CreatePost'</span>, &#123;</span><br><span class="line">            text: route.params?.post ? route.params?.post : <span class="string">''</span>,</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;Text style=&#123;&#123; <span class="attr">margin</span>: <span class="number">10</span> &#125;&#125;&gt;Post: &#123;route.params?.post&#125;&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CreatePostScreen</span>(<span class="params">&#123; navigation, route &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="comment">//将已经输入的内容，传递过来赋值给TextInput的处理逻辑</span></span><br><span class="line">  <span class="keyword">let</span> &#123;text&#125; = route.params;</span><br><span class="line">  <span class="keyword">let</span> [postText, setPostText] = React.useState(text);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;TextInput</span><br><span class="line">        multiline</span><br><span class="line">        placeholder=<span class="string">"What's on your mind?"</span></span><br><span class="line">        style=&#123;&#123; <span class="attr">height</span>: <span class="number">200</span>, <span class="attr">padding</span>: <span class="number">10</span>, <span class="attr">backgroundColor</span>: <span class="string">'white'</span> &#125;&#125;</span><br><span class="line">        value=&#123;postText&#125;</span><br><span class="line">        onChangeText=&#123;setPostText&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;Button</span><br><span class="line">        title=<span class="string">"Done"</span></span><br><span class="line">        onPress=&#123;() =&gt; &#123;</span><br><span class="line">          <span class="comment">// Pass params back to home screen</span></span><br><span class="line">          navigation.navigate(<span class="string">'Home'</span>, &#123; <span class="attr">post</span>: postText &#125;);</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>当点击”Done“按钮，TextInput输入的内容就会回传到主页面上并刷新展示在页面上。</p>
<h2 id="4-3-嵌套的导航页面传递参数"><a href="#4-3-嵌套的导航页面传递参数" class="headerlink" title="4.3 嵌套的导航页面传递参数"></a>4.3 嵌套的导航页面传递参数</h2><p>如果你有一个嵌套的导航器，传递参数有些许不同。例如，你有一个叫做Account的页面，想要传递参数到Settings页面。需要做如下操作：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">navigation.navigate(<span class="string">'Account'</span>, &#123;</span><br><span class="line">  screen: <span class="string">'Settings'</span>,</span><br><span class="line">  params: &#123; <span class="attr">user</span>: <span class="string">'jane'</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h2 id="4-4-总结"><a href="#4-4-总结" class="headerlink" title="4.4 总结"></a>4.4 总结</h2><ul>
<li>navigate和push在导航页面时可以作为可选的第二个参数传递参数。例如：navigation.navigate(‘RouteName’, {paramName: ‘value’})。</li>
<li>在页面上可以通过route.params读取传递的参数。</li>
<li>可以通过navigation.setParams更新页面参数。</li>
<li>通过initialParams属性可以传递初始化的参数。</li>
</ul>
<h1 id="5-配置Header-bar"><a href="#5-配置Header-bar" class="headerlink" title="5. 配置Header bar"></a>5. 配置Header bar</h1><p>我们已经知道怎么配置header标题，但是让我们在学习其他options之前再回顾一遍——复习是学习的关键</p>
<h2 id="5-1-设置header标题"><a href="#5-1-设置header标题" class="headerlink" title="5.1 设置header标题"></a>5.1 设置header标题</h2><p>组件接受options prop，它是一个对象或返回一个对象的函数，它包含各种配置选项。其中一个就是title，看下面的例子：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StackScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;&#123; <span class="attr">title</span>: <span class="string">'My home'</span> &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<h2 id="5-2-在title中使用参数"><a href="#5-2-在title中使用参数" class="headerlink" title="5.2 在title中使用参数"></a>5.2 在title中使用参数</h2><p>为了在title中使用参数，我们需要为页面设置一个返回配置对象的函数。在options中尝试使用this.props是很有用的，但是在组件渲染之前，没有引用组件的实例，因此没有可用的props。相反，如果我们将options设置为一个函数，那么React Navigation将用一个包含{Navigation, route}的对象调用它——在这种情况下，我们所关心的是route，它与作为route prop传递给页面prop的对象是同一对象。还记得我们可以通过route得到参数。参数，下面我们用这个来提取参数并使用它作为标题。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StackScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;&#123; <span class="attr">title</span>: <span class="string">'My home'</span> &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Profile"</span></span><br><span class="line">        component=&#123;ProfileScreen&#125;</span><br><span class="line">        options=&#123;(&#123; route &#125;) =&gt; (&#123; <span class="attr">title</span>: route.params.name &#125;)&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>传入选项函数的参数是一个具有以下属性的对象:</p>
<ul>
<li>navigation - 页面navigation prop</li>
<li>route - 页面route prop</li>
</ul>
<h2 id="5-3-用setOptions更新options"><a href="#5-3-用setOptions更新options" class="headerlink" title="5.3 用setOptions更新options"></a>5.3 用setOptions更新options</h2><p>通常需要在安装的屏幕组件本身更新活动页面的选项配置。我们可以使用navigation.setOptions来做实现</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Inside of render() of React class */</span></span><br><span class="line">&lt;Button</span><br><span class="line">  title=<span class="string">"Update the title"</span></span><br><span class="line">  onPress=&#123;() =&gt; navigation.setOptions(&#123; <span class="attr">title</span>: <span class="string">'Updated!'</span> &#125;)&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure></div>

<h2 id="5-4-调整header样式"><a href="#5-4-调整header样式" class="headerlink" title="5.4 调整header样式"></a>5.4 调整header样式</h2><p>自定义header样式有3个关键属性：headerStyle,headerTintColor,和 headerTitleStyle。</p>
<ul>
<li>headerStyle：应用于包装头部的视图的样式对象。如果你设置它的backgroundColor，就是设置header的颜色。</li>
<li>headerTintColor：back按钮和标题都使用这个属性作为字体颜色。在下面的示例中，我们将色调设置为白色(#fff)，这样返回按钮和标题标题就是白色的。</li>
<li>headerTitleStyle：可以使用它来自定义fontFamily、fontWeight和其他text样式。</li>
</ul>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NavigationComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;&#123;</span><br><span class="line">          title: <span class="string">'My home'</span>,</span><br><span class="line">          headerStyle: &#123;</span><br><span class="line">            backgroundColor: <span class="string">'#f4511e'</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">          headerTintColor: <span class="string">'#fff'</span>,</span><br><span class="line">          headerTitleStyle: &#123;</span><br><span class="line">            fontWeight: <span class="string">'bold'</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>需要注意：</p>
<ol>
<li>在iOS上，状态栏上的字体和icon是黑色的，在深色的背景上显示不是很友好，我们不会在这里讨论它，但是您应该确保配置状态栏，使其适应状态栏指南您的屏幕颜色</li>
<li>我们仅仅在主页面配置了这些，当跳转到详情页面时，header又会恢复原来的样式。接下来，我们看看如何在页面之间共享样式。</li>
</ol>
<h2 id="5-5-页面之间共享options"><a href="#5-5-页面之间共享options" class="headerlink" title="5.5 页面之间共享options"></a>5.5 页面之间共享options</h2><p>通常，在多个页面上我们会设置一个相同样式的header。例如，你的公司品牌颜色是红色，然后页面header想设置为红色背景和白色字体。在上面的例子中，我们配置了主页面header的颜色，当我们跳转到详情页面时，header恢复到默认的样式了。如果我们将主页面的样式配置复制到详情页面上，那会很麻烦，如果app每个页面都需要这个样式呢？我们不用这么做，我们可以将样式配置移动到Stack.Navigator下的screenOptions属性上。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StackScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator</span><br><span class="line">      screenOptions=&#123;&#123;</span><br><span class="line">        headerStyle: &#123;</span><br><span class="line">          backgroundColor: <span class="string">'#f4511e'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        headerTintColor: <span class="string">'#fff'</span>,</span><br><span class="line">        headerTitleStyle: &#123;</span><br><span class="line">          fontWeight: <span class="string">'bold'</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;&#125;</span><br><span class="line">    &gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;&#123; <span class="attr">title</span>: <span class="string">'My home'</span> &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>现在，属于StackScreen上的页面都会有一个主题样式，但是，如果我们需要重载这些配置，有什么方法呢？</p>
<h2 id="5-6-用自定义组件代替标题"><a href="#5-6-用自定义组件代替标题" class="headerlink" title="5.6 用自定义组件代替标题"></a>5.6 用自定义组件代替标题</h2><p>有时候，你不仅仅只是想改变title的text和样式 – 比如，你想用一张图片替代标题，或者将标题设置为按钮。在这些案例中，你完全可以使用自定义的组件来重载标题</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">LogoTitle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Image</span><br><span class="line">      style=&#123;&#123; <span class="attr">width</span>: <span class="number">50</span>, <span class="attr">height</span>: <span class="number">50</span> &#125;&#125;</span><br><span class="line">      source=&#123;<span class="built_in">require</span>(<span class="string">'@expo/snack-static/react-native-logo.png'</span>)&#125;</span><br><span class="line">    /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StackScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;&#123; <span class="attr">headerTitle</span>: <span class="function"><span class="params">props</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">LogoTitle</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span> &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>
<blockquote>
<p>你可能注意到，为什么我们设置headerTitle为一个组件，而不是像之前一样设置title？因为headerTitle是Stack.Navigator的一个属性，headerTitle默认是一个Text组件，用来展示title的。</p>
</blockquote>
<h2 id="5-7-额外的配置"><a href="#5-7-额外的配置" class="headerlink" title="5.7 额外的配置"></a>5.7 额外的配置</h2><p>你可以在createStackNavigator reference里浏览stack navigator里所有的配置列表。</p>
<h2 id="5-8-总结"><a href="#5-8-总结" class="headerlink" title="5.8 总结"></a>5.8 总结</h2><ul>
<li>你可以通过options里的属性自定义页面的header样式。阅读所有的options in the API reference。</li>
<li>options可以是一个对象或者一个函数。当是函数时，它提供了一个包含navigation和route属性的对象。</li>
<li>在初始化时，可以通过screenOptions配置一个共享的样式。这个属性优先级高于配置</li>
</ul>
<h1 id="6-Header-buttons"><a href="#6-Header-buttons" class="headerlink" title="6. Header buttons"></a>6. Header buttons</h1><p>现在我们知道如何去定义header的外观了，接下来的操作，可能会让我们更有动力：通过自定义配置来响应用户的触摸。</p>
<h2 id="6-1-在header上添加button"><a href="#6-1-在header上添加button" class="headerlink" title="6.1 在header上添加button"></a>6.1 在header上添加button</h2><p>大多数header上的交互是在左边或者右边有个按钮可以点击。让我们在header右边添加一个按钮（这是整个屏幕上最难触摸的地方之一，取决于手指和手机的大小，但也是放置按钮的正常位置）。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StackScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;&#123;</span><br><span class="line">          headerTitle: <span class="function"><span class="params">props</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">LogoTitle</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>,</span><br><span class="line">          headerRight: <span class="function"><span class="params">()</span> =&gt;</span> (</span><br><span class="line">            &lt;Button</span><br><span class="line">              onPress=&#123;() =&gt; alert(<span class="string">'This is a button!'</span>)&#125;</span><br><span class="line">              title=<span class="string">"Info"</span></span><br><span class="line">              color=<span class="string">"#fff"</span></span><br><span class="line">            /&gt;</span><br><span class="line">          ),</span><br><span class="line">        &#125;&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>

<p>当我们通过这个方法定义按钮，由于它不是HomeScreen实例的变量选项，因此不能使用setState或者其他实例方法去改变它。这是非常重要的，因为在header上添加button交互是非常常见的。因此，我们看看接下来怎么做。</p>
<h2 id="6-2-Header与页面组件的交互"><a href="#6-2-Header与页面组件的交互" class="headerlink" title="6.2  Header与页面组件的交互"></a>6.2  Header与页面组件的交互</h2><p>为了能够与页面组件交互，我们使用navigation.setOptions代替options属性来定义button。在页面组件中使用navigation.setOptions，我们可以访问页面的props，state，context等。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">StackScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen</span><br><span class="line">        name=<span class="string">"Home"</span></span><br><span class="line">        component=&#123;HomeScreen&#125;</span><br><span class="line">        options=&#123;(&#123; navigation, route &#125;) =&gt; (&#123;</span><br><span class="line">          headerTitle: <span class="function"><span class="params">props</span> =&gt;</span> <span class="xml"><span class="tag">&lt;<span class="name">LogoTitle</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>,</span><br><span class="line">        &#125;)&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function HomeScreen(&#123; navigation &#125;) &#123;</span></span><br><span class="line"><span class="regexp">  const [count, setCount] = React.useState(0);</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  React.useLayoutEffect(() =&gt; &#123;</span></span><br><span class="line"><span class="regexp">    navigation.setOptions(&#123;</span></span><br><span class="line"><span class="regexp">      headerRight: () =&gt; (</span></span><br><span class="line"><span class="regexp">        &lt;Button title="Update count!" onPress=&#123;() =&gt; setCount((c) =&gt; c + 1)&#125; /</span>&gt;</span><br><span class="line">      ),</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, [navigation, setCount]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">Text</span>&gt;</span>Count: &#123;count&#125;<span class="tag">&lt;/<span class="name">Text</span>&gt;</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="6-3-自定义返回按钮"><a href="#6-3-自定义返回按钮" class="headerlink" title="6.3 自定义返回按钮"></a>6.3 自定义返回按钮</h2><p>createStackNavigator提供了特定平台的默认的返回按钮，在iOS上包含button和text，在可用空间中，text展示的是上个页面的标题，否则只展示Back内容。</p>
<p>你可以通过headerBackTitle和headerTruncatedBackTitle来修改label的行为（更多）。</p>
<p>你可以使用headerBackImage自定义返回按钮的图片。</p>
<h2 id="6-4-重写返回按钮"><a href="#6-4-重写返回按钮" class="headerlink" title="6.4  重写返回按钮"></a>6.4  重写返回按钮</h2><p>只要用户可以从当前页面返回之前的页面，返回按钮就会自动被渲染到栈导航器上–换句话说，只要在栈上有超过一个页面，返回按钮就会自动被渲染。</p>
<p>一般来说，这就是你想要的。但在某些情况下，您可能更希望定制back按钮，而不是通过上面提到的选项，在这种情况下，您可以将headerLeft选项设置为将要呈现的React元素，就像我们对headerRight所做的那样。另外，headerLeft选项还接受一个React组件，例如，可以使用该组件重写back按钮的onPress行为。更多相关内容请参阅api reference。</p>
<h2 id="6-5-总结"><a href="#6-5-总结" class="headerlink" title="6.5  总结"></a>6.5  总结</h2><ul>
<li>你可以用options里的headerLeft和headerRight属性，在header上设置buttons。</li>
<li>返回按钮可以完全使用headerLeft自定义，但假如你仅仅只是想修改title和image，有其他的属性可以设置–headerBackTitle、headerTruncatedBackTitle，和headerBackImage。</li>
</ul>
<h1 id="7-嵌套的导航"><a href="#7-嵌套的导航" class="headerlink" title="7 嵌套的导航"></a>7 嵌套的导航</h1><p>嵌套的导航意思是在一个导航上的页面里渲染另一个导航，例如：</p>
<p>首先做下前期工作，安装需要的组件库，这里需要用到@react-navigation/bottom-tabs：</p>
<ul>
<li>npm<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @react-navigation&#x2F;bottom-tabs</span><br></pre></td></tr></table></figure></div></li>
<li>yarn<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @react-navigation&#x2F;bottom-tabs</span><br></pre></td></tr></table></figure></div>

</li>
</ul>
<p>然后开始我们的编码：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 自定义NestingNavigators.js文件，在App.js中引入即可 */</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Text, View, Button&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;NavigationContainer&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createStackNavigator&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/stack'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createBottomTabNavigator&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/bottom-tabs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Feed</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View</span><br><span class="line">      <span class="comment">// eslint-disable-next-line react-native/no-inline-styles</span></span><br><span class="line">      style=&#123;&#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#e3e'</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Feed Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Profile"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; navigation.navigate('Profile')&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function Messages() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;View</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ eslint-disable-next-line react-native/</span>no-inline-styles</span><br><span class="line">      style=&#123;&#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#b33'</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Messages Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Tab = createBottomTabNavigator();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Home</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Tab.Navigator&gt;</span><br><span class="line">      &lt;Tab.Screen name=<span class="string">"Feed"</span> component=&#123;Feed&#125; /&gt;</span><br><span class="line">      &lt;Tab.Screen name=<span class="string">"Messages"</span> component=&#123;Messages&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Tab.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function Profile() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;View</span></span><br><span class="line"><span class="regexp">      /</span><span class="regexp">/ eslint-disable-next-line react-native/</span>no-inline-styles</span><br><span class="line">      style=&#123;&#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#a3e'</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Profile Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Settings</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View</span><br><span class="line">      <span class="comment">// eslint-disable-next-line react-native/no-inline-styles</span></span><br><span class="line">      style=&#123;&#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#e3a'</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Settings Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Stack = createStackNavigator();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NestingNavigators</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NavigationContainer&gt;</span><br><span class="line">      &lt;Stack.Navigator&gt;</span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Home"</span> component=&#123;Home&#125; /&gt;</span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Profile"</span> component=&#123;Profile&#125; /&gt;</span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Settings"</span> component=&#123;Settings&#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> NestingNavigators;</span><br></pre></td></tr></table></figure></div>

<p>(注：官方文档代码省略了很多，我这边弄了个完整的，有兴趣的童鞋也可以自己实现！)</p>
<p>在上面的例子中，Home组件包含了一个tab导航。在整个App组件中，Home组件也被用在stack导航的Home页面上。因此，这里的tab导航是嵌套在stack导航里面的：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">* Stack.Navigator</span><br><span class="line">   。Home (Tab.Navigator)</span><br><span class="line">      . Feed (Screen)</span><br><span class="line">      . Messages (Screen)</span><br><span class="line">   。Profile (Screen)</span><br><span class="line">   。Settings (Screen)</span><br></pre></td></tr></table></figure></div>

<p>嵌套导航器的工作原理非常类似于嵌套常规组件。为了实现您想要的行为，通常需要嵌套多个导航器。</p>
<h2 id="7-1-嵌套导航有什么影响"><a href="#7-1-嵌套导航有什么影响" class="headerlink" title="7.1 嵌套导航有什么影响"></a>7.1 嵌套导航有什么影响</h2><p>当嵌套导航时，有些东西要注意：</p>
<h3 id="7-1-1-每个导航器保存自己的导航历史"><a href="#7-1-1-每个导航器保存自己的导航历史" class="headerlink" title="7.1.1 每个导航器保存自己的导航历史"></a>7.1.1 每个导航器保存自己的导航历史</h3><p>比如，在一个嵌套的stack导航里点击了返回按钮，它将返回到嵌套的栈内的上一个页面，即使有另一个导航器作为父视图。</p>
<h3 id="7-1-2-导航操作由当前导航器处理，如果无法处理就由它的父导航处理"><a href="#7-1-2-导航操作由当前导航器处理，如果无法处理就由它的父导航处理" class="headerlink" title="7.1.2 导航操作由当前导航器处理，如果无法处理就由它的父导航处理"></a>7.1.2 导航操作由当前导航器处理，如果无法处理就由它的父导航处理</h3><p>例如，如果你在一个嵌套的页面上调用navigation.goBack()，如果已经在第一个页面上了，那么仅仅会返回到父导航。其他操作比如navigate在效果上是一样的，例如，在嵌套的导航里操作导航，但这个操作没有处理，然后父导航将会处理这个操作。在上例中，当在Feed页面上调用navigate(‘Messages’)，这个嵌套的tab导航会处理它，但是如果你调用navigate(‘Settings’)，父栈导航器将会处理它。</p>
<h3 id="7-1-3-嵌套导航不接收父事件"><a href="#7-1-3-嵌套导航不接收父事件" class="headerlink" title="7.1.3  嵌套导航不接收父事件"></a>7.1.3  嵌套导航不接收父事件</h3><p>例如，你有一个栈导航嵌套在tab导航里，在栈导航上的页面不会收到父tab导航发出的通知事件，比如（tabPress）时添加navigation.addListener监听。为了能收到父导航的事件，你可以使用navigation.dangerouslyGetParent().addListener来监听父事件。</p>
<h3 id="7-1-4-父导航的UI渲染在子导航的顶部"><a href="#7-1-4-父导航的UI渲染在子导航的顶部" class="headerlink" title="7.1.4 父导航的UI渲染在子导航的顶部"></a>7.1.4 父导航的UI渲染在子导航的顶部</h3><p>例如，当嵌套一个栈导航到折叠（抽屉）导航里，你会看到折叠页面在栈导航的头部。然而，如果你嵌套一个折叠导航到栈导航里，折叠页面会出现在header下面。这是一个很重要的点，对于你决定如何嵌套导航。</p>
<p>在你的App中，你可能会根据你想要的行为使用这些模式:</p>
<ul>
<li>栈导航嵌套在折叠导航的每个页面中-折叠页面出现在栈的header上面。</li>
<li>Tab导航嵌套在栈导航的初始页面里-当push页面时，新页面会覆盖tab bar。</li>
<li>栈导航嵌套在tab导航的每个页面中-tab bar总是可见的。点击tab会再次pops到栈顶。</li>
</ul>
<h2 id="7-2-导航到一个嵌套导航里的页面"><a href="#7-2-导航到一个嵌套导航里的页面" class="headerlink" title="7.2 导航到一个嵌套导航里的页面"></a>7.2 导航到一个嵌套导航里的页面</h2><p>考虑下面的例子：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Root</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Stack.Navigator&gt;</span><br><span class="line">      &lt;Stack.Screen name=<span class="string">"Profile"</span> component=&#123;Profile&#125; /&gt;</span><br><span class="line">      &lt;Stack.Screen name=<span class="string">"Settings"</span> component=&#123;Settings&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Drawer = createDrawerNavigator();</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function NestingNavigators() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;NavigationContainer&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Drawer.Navigator&gt;</span></span><br><span class="line"><span class="regexp">        &lt;Drawer.Screen name="Home" component=&#123;Home&#125; /</span>&gt;</span><br><span class="line">        &lt;Drawer.Screen name=<span class="string">"Root"</span> component=&#123;Root&#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Drawer.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>这里，你可能想从Home页面导航到Root栈页：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigation.navigate(<span class="string">'Root'</span>);</span><br></pre></td></tr></table></figure></div>
<p>这是可以的，Root组件里的初始页面会展示，没错，就是Profile。但有时，你可能想在导航上控制想展示的页面。通过下面操作，你能在参数里指定页面的名称：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigation.navigate(<span class="string">'Root'</span>, &#123; <span class="attr">screen</span>: <span class="string">'Settings'</span> &#125;);</span><br></pre></td></tr></table></figure></div>
<p>现在，Settings将会代替Profile展示在导航上。</p>
<p>这看起来可能与以前使用嵌套页面的导航方式非常不同。与之前的差异是，所有的配置都是静态的，因此，React Navigation可以通过递归到嵌套配置中，静态地找到所有导航器及其页面的列表。但是使用动态配置，React Navigation不知道哪些页面可用，在哪里可用，直到导航器包含页面渲染后。通常，还没导航到一个页面的时候，这个页面的内容不会被渲染，所以还没有渲染的导航器的配置是不可用的。这就需要指定导航到的层次结构。这也是为什么你应该使用尽可能少的导航器嵌套以使代码更简单的原因。</p>
<h3 id="7-2-1-在嵌套导航传递参数到页面"><a href="#7-2-1-在嵌套导航传递参数到页面" class="headerlink" title="7.2.1 在嵌套导航传递参数到页面"></a>7.2.1 在嵌套导航传递参数到页面</h3><p>你也可以通过一个指定的参数key传递参数：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">navigation.navigate(<span class="string">'Root'</span>, &#123;</span><br><span class="line">  screen: <span class="string">'Settings'</span>,</span><br><span class="line">  params: &#123; <span class="attr">user</span>: <span class="string">'jane'</span> &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<p>如果导航已经渲染，在使用栈导航时跳转到另一个页面就会push到一个新的页面。</p>
<p>对于深度嵌套的屏幕，可以采用类似的方法。注意navigate的第二个参数，也就是params，也可以这样做：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">navigation.navigate(<span class="string">'Root'</span>, &#123;</span><br><span class="line">  screen: <span class="string">'Settings'</span>,</span><br><span class="line">  params: &#123;</span><br><span class="line">    screen: <span class="string">'Sound'</span>,</span><br><span class="line">    params: &#123;</span><br><span class="line">      screen: <span class="string">'Media'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>
<p>上面的案例中，你想要导航到Media页面，他是嵌套在Sound页面里面的，Sound页面又嵌套在Settings页面里。</p>
<h3 id="7-2-2-在导航器里渲染被定义的初始路由"><a href="#7-2-2-在导航器里渲染被定义的初始路由" class="headerlink" title="7.2.2 在导航器里渲染被定义的初始路由"></a>7.2.2 在导航器里渲染被定义的初始路由</h3><p>默认情况下，当导航到一个嵌套在导航里的页面时，被指定的页面会被用于初始页面，并且初始路由属性会被忽略。这个不同于React Navigation 4。</p>
<p>如果你想在导航里想渲染一个指定的初始页面，通过设置initial: false，您可以禁用使用指定页面作为初始页面的行为：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">navigation.navigate(<span class="string">'Root'</span>, &#123;</span><br><span class="line">  screen: <span class="string">'Settings'</span>,</span><br><span class="line">  initial: <span class="literal">false</span>,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></div>

<h2 id="7-3-嵌套时的最佳实践"><a href="#7-3-嵌套时的最佳实践" class="headerlink" title="7.3 嵌套时的最佳实践"></a>7.3 嵌套时的最佳实践</h2><p>我们推荐减少嵌套导航到最小。尝试用尽可能少的嵌套来实现您想要的行为。嵌套有很多缺点:</p>
<ul>
<li><p>当导航到嵌套的页面时，代码变得难以理解</p>
</li>
<li><p>它会导致深度嵌套的视图层次结构，会导致低端设备的内存和性能问题</p>
</li>
<li><p>嵌套相同类型的导航器(例如tab在tab里，drawer在drawer里等等)会导致令人困惑的用户体验。</p>
</li>
</ul>
<p>将嵌套导航器看作是实现您想要的UI的一种方式，而不是组织代码的一种方式。如果您希望为组织创建单独的页面组，请将它们保存在单独的对象/数组中，而不是保存在单独的导航器中。</p>
<h1 id="8-Navigation生命周期"><a href="#8-Navigation生命周期" class="headerlink" title="8 Navigation生命周期"></a>8 Navigation生命周期</h1><p>在前面的部分，我操作了一个包含Home和Details两个页面的栈导航，并且使用navigation.navigate(‘RouteName’)在路由间导航。</p>
<p>在这方面的一个重要问题是：当我们离开Home页面时或返回到Home页面时发生了什么？用户如何知道离开了或返回到一个路由页面？</p>
<p>如果您从web角度来看react-navigation，那么您可以假设当用户从路由a导航到路由B时，A将被卸载（componentWillUnmount会被调用），当返回到A时，又会被加载。而这些React生命周期方法仍然有效并被使用在react-navigation，它们的用法和web是有区别的。这是由更复杂的移动导航需求驱动的。</p>
<h2 id="8-1-示例场景"><a href="#8-1-示例场景" class="headerlink" title="8.1 示例场景"></a>8.1 示例场景</h2><p>有一个包含A和B页面的栈导航。导航到A页面后，它的componentDidMount函数被调用。当push到B页面，它的componentDidMount也被调用，但是A仍然挂载在栈上，因此不调用它的componentWillUnmount。</p>
<p>当从B页面回到A时，B页面的componentWillUnmount被调用，但A的componentDidMount不会被调用，因为A在整个生命周期一直在栈上。</p>
<p>与其他导航器(结合使用)也可以观察到类似的结果。考虑一个tab导航上有两个tab，每个tab都在栈导航上：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Navigation生命周期 */</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Text, View, Button&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;NavigationContainer&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createStackNavigator&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/stack'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createBottomTabNavigator&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/bottom-tabs'</span>;</span><br><span class="line"><span class="comment">/*这里就省略了，减少篇幅，具体代码可以在前面代码里找*/</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Profile</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Settings</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">DetailScreen</span>(<span class="params"></span>) </span>&#123;...&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Tab = createBottomTabNavigator();</span><br><span class="line"><span class="keyword">const</span> SettingsStack = createStackNavigator();</span><br><span class="line"><span class="keyword">const</span> HomeStack = createStackNavigator();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NavigationLifeCycle</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NavigationContainer&gt;</span><br><span class="line">      &lt;Tab.Navigator&gt;</span><br><span class="line">        &lt;Tab.Screen name=<span class="string">"First"</span>&gt;</span><br><span class="line">          &#123;() =&gt; (</span><br><span class="line">            &lt;SettingsStack.Navigator&gt;</span><br><span class="line">              &lt;SettingsStack.Screen name=<span class="string">"Settings"</span> component=&#123;Settings&#125; /&gt;</span><br><span class="line">              &lt;SettingsStack.Screen name=<span class="string">"Profile"</span> component=&#123;Profile&#125; /&gt;</span><br><span class="line">            &lt;<span class="regexp">/SettingsStack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">          )&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>Tab.Screen&gt;</span><br><span class="line">        &lt;Tab.Screen name=<span class="string">"Second"</span>&gt;</span><br><span class="line">          &#123;() =&gt; (</span><br><span class="line">            &lt;HomeStack.Navigator&gt;</span><br><span class="line">              &lt;HomeStack.Screen name=<span class="string">"Home"</span> component=&#123;HomeScreen&#125; /&gt;</span><br><span class="line">              &lt;HomeStack.Screen name=<span class="string">"Details"</span> component=&#123;DetailScreen&#125; /&gt;</span><br><span class="line">            &lt;<span class="regexp">/HomeStack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">          )&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>Tab.Screen&gt;</span><br><span class="line">      &lt;<span class="regexp">/Tab.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> NavigationLifeCycle;</span><br></pre></td></tr></table></figure></div>

<p>刚开始在HomeScreen，然后导航到DetailsScreen。然后切换tab展示SettingsScreen页面，再导航到ProfileScreen。这部分操作已经完成，4个页面都已经加载了！如果你用tab切换回HomeStack，你将会看到DetailsScreen页面-HomeStack已经保存了导航状态。</p>
<h2 id="8-2-React-Navigation-的生命周期事件"><a href="#8-2-React-Navigation-的生命周期事件" class="headerlink" title="8.2 React Navigation 的生命周期事件"></a>8.2 React Navigation 的生命周期事件</h2><p>现在我们已经了解了React生命周期方法是如何在React Navigation中工作的，让我们解答一下刚开始的问题：”用户如何知道离开(blur)了或返回(focus)到一个路由页面？“</p>
<p>React Navigation向订阅事件的页面组件发出事件。我们可以监听focus和blur事件，就可以知道是否进入当前页面或离开了当前页面。</p>
<p>例如：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Profile</span>(<span class="params">&#123;navigation&#125;</span>) </span>&#123;</span><br><span class="line">  React.useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> unsubscribe = navigation.addListener(<span class="string">'focus'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="comment">//Screen was focused</span></span><br><span class="line">      <span class="comment">//Do sometings</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Profile page is focused!!!'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> unsubscribe;</span><br><span class="line">  &#125;, [navigation]);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View</span><br><span class="line">      <span class="comment">// eslint-disable-next-line react-native/no-inline-styles</span></span><br><span class="line">      style=&#123;&#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#a3e'</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Profile Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>参阅Navigation events了解更多事件和API的用法</p>
<p>我们可以使用useFocusEffect来执行，而不是手动添加事件监听器。它类似于React的useEffect，但它与导航生命周期紧密相连。</p>
<p>例如：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; useFocusEffect &#125; <span class="keyword">from</span> <span class="string">'@react-navigation/native'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Profile</span>(<span class="params">&#123;navigation&#125;</span>) </span>&#123;</span><br><span class="line">  useFocusEffect(</span><br><span class="line">    React.useCallback(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">//Do something when the screen is focused</span></span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'Profile page is focused!!!'</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">//Do something when the screen is unfocused</span></span><br><span class="line">        <span class="comment">// Useful for cleanup functions</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'Profile page is unfocused!!!'</span>);</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;, []),</span><br><span class="line">  );</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View</span><br><span class="line">      <span class="comment">// eslint-disable-next-line react-native/no-inline-styles</span></span><br><span class="line">      style=&#123;&#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#a3e'</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">      &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Profile Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>如果你想根据页面是否被聚焦来渲染不同的东西，你可以使用useIsFocused，它返回一个指示页面是否被聚焦的布尔值。</p>
<h2 id="8-3-总结"><a href="#8-3-总结" class="headerlink" title="8.3 总结"></a>8.3 总结</h2><ul>
<li>虽然React的生命周期方法仍然有效，但React导航添加了更多的事件，可以通过navigation属性来订阅。</li>
<li>你也可以用useFocusEffect或者useIsFocused来代替。</li>
</ul>
<h1 id="9-打开full-screen模态"><a href="#9-打开full-screen模态" class="headerlink" title="9 打开full-screen模态"></a>9 打开full-screen模态</h1><p>模态显示临时的与主视图交互的内容。</p>
<p>模态类似于一个弹框 – 它不是你的主要导航流程的一部分 – 它通常有一个不同的过渡，不同的方法dismiss它，并且专注于某一特定的内容或交互。</p>
<p>将其作为React导航基础原理的一部分进行解释的目的不仅仅是因为这是一个常见的用例，还因为需要嵌套导航器的知识来实现，它是React Navigation重要的一部分。</p>
<h2 id="9-1-创建模态栈"><a href="#9-1-创建模态栈" class="headerlink" title="9.1 创建模态栈"></a>9.1 创建模态栈</h2><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Navigation生命周期 */</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Text, View, Button&#125; <span class="keyword">from</span> <span class="string">'react-native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;NavigationContainer&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/native'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;createStackNavigator&#125; <span class="keyword">from</span> <span class="string">'@react-navigation/stack'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params">&#123;navigation&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="comment">// eslint-disable-next-line react-native/no-inline-styles</span></span><br><span class="line">    &lt;View style=&#123;&#123;<span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">      &lt;Text style=&#123;&#123;<span class="attr">fontSize</span>: <span class="number">30</span>&#125;&#125;&gt;This is the home screen!&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Open Modal"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt;</span></span><br><span class="line"><span class="regexp">          /</span>* <span class="number">1.</span>传递参数到详情页面 *<span class="regexp">/</span></span><br><span class="line"><span class="regexp">          navigation.navigate('MyModal')</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function DetailScreen() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    /</span><span class="regexp">/ eslint-disable-next-line react-native/</span>no-inline-styles</span><br><span class="line">    &lt;View style=&#123;&#123;<span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Detail Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ModalScreen</span>(<span class="params">&#123;navigation&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="comment">// eslint-disable-next-line react-native/no-inline-styles</span></span><br><span class="line">    &lt;View style=&#123;&#123;<span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>&#125;&#125;&gt;</span><br><span class="line">      &lt;Text style=&#123;&#123;<span class="attr">fontSize</span>: <span class="number">30</span>&#125;&#125;&gt;This is a Modal!&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button title="Dismiss" onPress=&#123;() =&gt; navigation.goBack()&#125; /</span>&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const MainStack = createStackNavigator();</span></span><br><span class="line"><span class="regexp">const RootStack = createStackNavigator();</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function MainStackScreen() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;MainStack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">      &lt;MainStack.Screen name="Home" component=&#123;HomeScreen&#125; /</span>&gt;</span><br><span class="line">      &lt;MainStack.Screen name=<span class="string">"Details"</span> component=&#123;DetailScreen&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/MainStack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function NavigationModal() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;NavigationContainer&gt;</span></span><br><span class="line"><span class="regexp">      &lt;RootStack.Navigator mode="modal"&gt;</span></span><br><span class="line"><span class="regexp">        &lt;RootStack.Screen</span></span><br><span class="line"><span class="regexp">          name="Main"</span></span><br><span class="line"><span class="regexp">          component=&#123;MainStackScreen&#125;</span></span><br><span class="line"><span class="regexp">          options=&#123;&#123;headerShown: false&#125;&#125;</span></span><br><span class="line"><span class="regexp">        /</span>&gt;</span><br><span class="line">        &lt;RootStack.Screen</span><br><span class="line">          name=<span class="string">"MyModal"</span></span><br><span class="line">          component=&#123;ModalScreen&#125;</span><br><span class="line">          options=&#123;&#123;<span class="attr">headerShown</span>: <span class="literal">false</span>&#125;&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/RootStack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> NavigationModal;</span><br></pre></td></tr></table></figure></div>

<p>有些重要的事情要注意一下：</p>
<ul>
<li>我们用MainStackScreen组件作为RootStackScreen的一个页面！这里，我们是嵌套了一个栈导航在另一个栈导航里。这样做是完全有效的，因为我们想要使用模态实现不同的过渡方式。由于RootStackScreen渲染一个栈导航器，并有自己的header，我们也想隐藏这个页面的header。在将来它将是重要的，对于tab导航，例如，每个tab会有自己的栈。直观上，这就是你所期望的：当你从tab A切换到tab B，在继续浏览tab B时，您希望tab A保持其导航状态。请看这张图，在这个例子中可以看到导航的结构:</li>
</ul>
<p><a href="/img/react/stack.png" data-fancybox="group" data-caption="avatar" class="fancybox"><img alt="avatar" title="avatar" data-src="/img/react/stack.png" class="lazyload"></a></p>
<ul>
<li><p>在栈导航上，mode属性可以是：card（默认）和 modal。在iOS上，modal的行为从底部滑动屏幕，并允许用户从顶部向下滑动来关闭它。modal属性在Android上没有影响，因为全屏模式在平台上没有任何不同的转换行为。</p>
</li>
<li><p>当我们调用navigate时，我们不需要指定任何东西除了我们想要导航到的路由。不需要限定它属于哪个堆栈(任意命名的“根”或“主”堆栈)—React导航尝试在最近的导航器上查找路由，然后在那里执行操作。为了使其可视化，请再次查看上面的树形图，并想象navigate动作从主屏幕流向主堆栈。我们知道MainStack不能处理路由MyModal，所以它会将它流到RootStack，后者能处理那个路由，所以它确实做到了</p>
</li>
</ul>
<h2 id="9-2-总结"><a href="#9-2-总结" class="headerlink" title="9.2 总结"></a>9.2 总结</h2><ul>
<li><p>在栈导航上想要改变过渡方式，可以使用mode属性。当设置为modal时，所有的屏幕都是动态的——从下到上而不是从右到左。这适用于整个堆栈导航器，因此为了在其他页面上使用从右到左的转换，我们添加另一个具有默认配置的导航堆栈。</p>
</li>
<li><p>navigation.navigate导航遍历导航器树以查找可以处理导航操作的导航器。</p>
</li>
</ul>
<h1 id="10-专业术语"><a href="#10-专业术语" class="headerlink" title="10 专业术语"></a>10 专业术语</h1><blockquote>
<p>这是文档的新部分，缺少很多术语！ 请提交拉取请求或您认为应该在此处解释的术语问题。</p>
</blockquote>
<h2 id="10-1-Header"><a href="#10-1-Header" class="headerlink" title="10.1 Header"></a>10.1 Header</h2><p>也称为navigation header，navigation bar，navbar，可能还有许多其他内容。 这是屏幕顶部的矩形，其中包含后退按钮和屏幕标题。 整个矩形在React Navigation中通常称为标头。</p>
<h2 id="10-2-Navigator"><a href="#10-2-Navigator" class="headerlink" title="10.2 Navigator"></a>10.2 Navigator</h2><p>导航器包含Screen元素作为其子元素，以定义路由的配置。 NavigationContainer是管理导航树并包含导航状态的组件。 该组件必须包装所有导航器结构。 通常，我们会在应用程序的根目录下渲染此组件，通常是从App.js导出的组件。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NavigationContainer&gt;</span><br><span class="line">      &lt;Stack.Navigator&gt; <span class="comment">// &lt;---- This is a Navigator</span></span><br><span class="line">        &lt;Stack.Screen name=<span class="string">"Home"</span> component=&#123;HomeScreen&#125; /&gt;</span><br><span class="line">      &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>NavigationContainer&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h2 id="10-3-Screen-component"><a href="#10-3-Screen-component" class="headerlink" title="10.3 Screen component"></a>10.3 Screen component</h2><p>屏幕组件是我们在路由配置中使用的组件。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> Stack = createStackNavigator();</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> StackNavigator = (</span><br><span class="line">  &lt;Stack.Navigator&gt;</span><br><span class="line">    &lt;Stack.Screen</span><br><span class="line">      name=<span class="string">"Home"</span></span><br><span class="line">      component=&#123;HomeScreen&#125; <span class="comment">// &lt;----</span></span><br><span class="line">    /&gt;</span><br><span class="line">    &lt;Stack.Screen</span><br><span class="line">      name=<span class="string">"Details"</span></span><br><span class="line">      component=&#123;DetailsScreen&#125; <span class="comment">// &lt;----</span></span><br><span class="line">    /&gt;</span><br><span class="line">  &lt;<span class="regexp">/Stack.Navigator&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure></div>
<p>组件名称中的后缀Screen完全是可选的，但是是经常使用的约定。 我们可以称其为Michael，它的工作原理相同。</p>
<p>前面我们看到，我们的屏幕组件是随导航prop一起提供的。 重要的是要注意，仅当屏幕由React Navigation渲染为路由时（例如，响应于navigation.navigate），才会发生这种情况。 例如，如果我们将DetailsScreen作为HomeScreen的子级呈现，则DetailsProperty将不会随导航prop一起提供，并且当您在主屏幕上按“再次转到Details …”按钮时，该应用将抛出一个 典型的JavaScript异常“undefined is not an object”。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HomeScreen</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;View style=&#123;&#123; <span class="attr">flex</span>: <span class="number">1</span>, <span class="attr">alignItems</span>: <span class="string">'center'</span>, <span class="attr">justifyContent</span>: <span class="string">'center'</span> &#125;&#125;&gt;</span><br><span class="line">      &lt;Text&gt;Home Screen&lt;<span class="regexp">/Text&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Button</span></span><br><span class="line"><span class="regexp">        title="Go to Details"</span></span><br><span class="line"><span class="regexp">        onPress=&#123;() =&gt; navigation.navigate('Details')&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">      &lt;DetailsScreen /&gt;</span><br><span class="line">    &lt;<span class="regexp">/View&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure></div>
<p>“Navigation prop reference”<br>部分对此进行了更详细的介绍，介绍了解决方法，并提供了有关导航prop上其他可用属性的更多信息。</p>
<h2 id="10-3-Navigation-Prop"><a href="#10-3-Navigation-Prop" class="headerlink" title="10.3 Navigation Prop"></a>10.3 Navigation Prop</h2><p>该prop将传递到所有页面，可用于以下用途：</p>
<ul>
<li>dispatch将向路由器发送一个动作</li>
<li>navigate，goBack等可用于以方便的方式调度操作<br>导航器也可以接受导航prop，如果有的话，它们应该从父导航器获得。</li>
</ul>
<p>更多细节，请参考”Navigation prop document”.</p>
<p>“Route prop reference”<br>部分对此进行了更详细的介绍，介绍了解决方法，并提供了有关路由prop上其他可用属性的更多信息。</p>
<h2 id="10-4-Route-prop"><a href="#10-4-Route-prop" class="headerlink" title="10.4 Route prop"></a>10.4 Route prop</h2><p>该prop将传递到所有页面。 包含有关当前路由的信息，即参数，key和name。</p>
<h2 id="10-5-Navigation-State"><a href="#10-5-Navigation-State" class="headerlink" title="10.5 Navigation State"></a>10.5 Navigation State</h2><p>导航器的状态通常如下所示：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  key: <span class="string">'StackRouterRoot'</span>,</span><br><span class="line">  index: <span class="number">1</span>,</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; <span class="attr">key</span>: <span class="string">'A'</span>, <span class="attr">name</span>: <span class="string">'Home'</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">key</span>: <span class="string">'B'</span>, <span class="attr">name</span>: <span class="string">'Profile'</span> &#125;,</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>
<p>对于此导航状态，有两个路由（可以是tabs或堆栈中的cards）。 索引指向活动路由，即“ B”。</p>
<h2 id="10-6-Route"><a href="#10-6-Route" class="headerlink" title="10.6 Route"></a>10.6 Route</h2><p>每个路由都是一个导航状态，其中包含一个用于识别它的键以及一个用于指定路由类型的“名称”。 它还可以包含任意参数：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  key: <span class="string">'B'</span>,</span><br><span class="line">  name: <span class="string">'Profile'</span>,</span><br><span class="line">  params: &#123; <span class="attr">id</span>: <span class="string">'123'</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h1 id="11-兼容层"><a href="#11-兼容层" class="headerlink" title="11 兼容层"></a>11 兼容层</h1><blockquote>
<p>注意：在遵循本指南之前，请确保您已按照入门指南在应用程序中设置React Navigation 5。</p>
</blockquote>
<p>React Navigation 5具有全新的API，因此我们使用React Navigation 4的旧代码将不再适用于该版本。 如果您不熟悉新的API，则可以阅读升级指南中的差异。 我们知道这可能需要做很多工作，因此我们创建了一个兼容性层来简化此过程。</p>
<p>使用这个兼容性层，需要安装@react-navigation/compat:</p>
<ul>
<li>npm<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install @react-navigation&#x2F;native @react-navigation&#x2F;compat @react-navigation&#x2F;stack</span><br></pre></td></tr></table></figure></div></li>
<li>yarn<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add @react-navigation&#x2F;native @react-navigation&#x2F;compat @react-navigation&#x2F;stack</span><br></pre></td></tr></table></figure></div>

</li>
</ul>
<p>然后在我们的代码里要做一些小小的改动：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//“-”代表删除，“+”代表添加</span></span><br><span class="line">-<span class="keyword">import</span> &#123; createStackNavigator &#125; <span class="keyword">from</span> <span class="string">'react-navigation-stack'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createStackNavigator &#125; <span class="keyword">from</span> <span class="string">'@react-navigation/stack'</span>;</span><br><span class="line">+<span class="keyword">import</span> &#123; createCompatNavigatorFactory &#125; <span class="keyword">from</span> <span class="string">'@react-navigation/compat'</span>;</span><br><span class="line">-<span class="keyword">const</span> RootStack = createStackNavigator(</span><br><span class="line">+<span class="keyword">const</span> RootStack = createCompatNavigatorFactory(createStackNavigator)(</span><br><span class="line">  &#123;</span><br><span class="line">    Home: &#123; <span class="attr">screen</span>: HomeScreen &#125;,</span><br><span class="line">    Profile: &#123; <span class="attr">screen</span>: ProfileScreen &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    initialRouteName: <span class="string">'Profile'</span>,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure></div>

<p>如果之前导入的是react-navigation，那么现在要修改一下，导入 @react-navigation/compat:</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//“-”代表删除，“+”代表添加</span></span><br><span class="line">-<span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span>; </span><br><span class="line">+<span class="keyword">import</span> &#123; NavigationActions &#125; <span class="keyword">from</span> <span class="string">'@react-navigation/compat'</span>;</span><br></pre></td></tr></table></figure></div>

<p>该库导出以下API：</p>
<ul>
<li>Actions: <br></li>
<li><blockquote>
<p>NavigationActions <br></p>
</blockquote>
</li>
<li><blockquote>
<p>StackActions <br></p>
</blockquote>
</li>
<li><blockquote>
<p>DrawerActions <br></p>
</blockquote>
</li>
<li><blockquote>
<p>SwitchActions <br></p>
</blockquote>
</li>
<li>HOCs<br></li>
<li><blockquote>
<p>withNavigation<br></p>
</blockquote>
</li>
<li><blockquote>
<p>withNavigationFocus<br></p>
</blockquote>
</li>
<li>Navigators<br></li>
<li><blockquote>
<p>createSwitchNavigator<br></p>
</blockquote>
</li>
<li>Compatibility helpers<br></li>
<li><blockquote>
<p>createCompatNavigatorFactory - 使用v5 API的导航器，并使用v4 API返回createXNavigator。<br></p>
</blockquote>
</li>
<li><blockquote>
<p>createCompatNavigationProp - 将v5导航对象与route对象一起使用，并返回v4导航对象。<br></p>
</blockquote>
</li>
</ul>
<h2 id="11-1-它处理什么？"><a href="#11-1-它处理什么？" class="headerlink" title="11.1 它处理什么？"></a>11.1 它处理什么？</h2><p>兼容性层处理React Navigation 4和5之间的各种API差异：</p>
<ul>
<li><p>使用v4的静态配置API代替基于组件的API。</p>
</li>
<li><p>更改导航对象上方法的签名以匹配v4。</p>
</li>
<li><p>添加对在5版中删除的screenProps的支持。</p>
</li>
<li><p>导出action创建者，例如NavigationActions，StackActions，SwitchActions，其签名与v4相同。</p>
</li>
</ul>
<h2 id="11-2-它不处理什么？"><a href="#11-2-它不处理什么？" class="headerlink" title="11.2 它不处理什么？"></a>11.2 它不处理什么？</h2><p>由于React Navigation 5的动态API，v4的静态API不再具有某些功能，因此兼容性层无法处理它们：</p>
<ul>
<li><p>它不包装导航器的prop或options。 基本上，这意味着您要传递给导航器的options可能会因导航器中的重大更改而有所不同。 请参阅导航器的文档以获取更新选项API。</p>
</li>
<li><p>不支持通过在路由配置中定义路径来支持旧式深层链接。 请参阅deep linking documentation<br>以获取更多详细信息，现在如何处理深层链接。</p>
</li>
<li><p>导航到导航器的工作原理不同，即，我们无法导航到尚未渲染的导航器中的屏幕，并且无法将参数合并到所有子屏幕。 有关如何导航到其他导航器中的屏幕的更多详细信息，请参见嵌套导航器文档。</p>
</li>
<li><p>不再支持某些采取一系列操作的方法，例如旧式重置方法。 不支持的方法在使用它们时会抛出错误，如果我们使用的是TypeScript，则会给出类型错误。</p>
</li>
<li><p>它不会导出createAppContainer，因此您需要为容器（NavigationContainer）使用v5 API。 这也意味着容器支持的所有功能都需要迁移到新的API。</p>
</li>
<li><p>如果您使用的是Redux集成，自定义路由器和操作等高级API，则不再支持它们，则需要删除Redux集成。<br>尽管我们已尽最大努力使兼容性层处理大多数差异，但可能会丢失某些内容。 因此，请确保测试已迁移的代码。</p>
</li>
</ul>
<h2 id="为什么我们应该使用它？"><a href="#为什么我们应该使用它？" class="headerlink" title="为什么我们应该使用它？"></a>为什么我们应该使用它？</h2><p>使用兼容性层可以使我们将代码逐步迁移到新版本。 不幸的是，我们确实必须更改一些代码才能使兼容性层正常工作（请参阅“它不处理的内容”），但是它仍然允许我们的大多数代码保持不变。 使用兼容层的一些优点包括：</p>
<ul>
<li>它允许我们使用新API编写新代码，同时使用旧版API与代码集成，即，您可以从用新API编写的代码导航到用旧版API定义的屏幕，反之亦然。</li>
<li>由于它建立在具有出色TypeScript支持的v5之上，因此旧代码也可以利用改进的类型检查功能，当您以后想要将其重构为新API时，这将非常有用。</li>
<li>您可以详细了解迁移情况，例如 仅将组件中的几种方法迁移到新的API。 您仍然可以访问navigation.original上的v5导航对象，可用于逐步迁移代码。</li>
<li>您可以访问旧组件中的新API，例如navigation.setOptions或新hooks，例如useFocusEffect。</li>
</ul>
<p>我们致力于帮助您尽可能轻松地进行升级。 因此，请提出有关兼容性层不支持的用例的问题，以便我们找出一个好的迁移策略。</p>
<h1 id="12-故障排除"><a href="#12-故障排除" class="headerlink" title="12 故障排除"></a>12 故障排除</h1><p>本节试图概述用户首次习惯使用React Navigation时经常遇到的问题。 这些问题可能与React Navigation本身有关，也可能无关。</p>
<p>解决问题之前，请确保已升级到软件包的最新可用版本。 您可以通过再次安装软件包来安装最新版本（例如npm install package-name）。</p>
<h2 id="12-1-更新了最新版本，得到“Unable-to-resolve-module”错误"><a href="#12-1-更新了最新版本，得到“Unable-to-resolve-module”错误" class="headerlink" title="12.1 更新了最新版本，得到“Unable to resolve module”错误"></a>12.1 更新了最新版本，得到“Unable to resolve module”错误</h2><p>有三个原因：</p>
<p>Metro捆绑器的过时缓存</p>
<p>如果模块指向本地文件（即模块名称以./开头），则可能是由于过时的缓存所致。 要解决此问题，请尝试以下解决方案。</p>
<p>如果使用Expo，运行：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Javascript</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">expo start -c</span><br></pre></td></tr></table></figure></div>
<p>如果使用的不是Expo，运行：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx react-native start --reset-cache</span><br></pre></td></tr></table></figure></div>
<p>如果都不起作用，请做如下操作：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm -rf $TMPDIR&#x2F;metro-bundler-cache-*</span><br></pre></td></tr></table></figure></div>

<h2 id="12-2-缺少对等依赖"><a href="#12-2-缺少对等依赖" class="headerlink" title="12.2 缺少对等依赖"></a>12.2 缺少对等依赖</h2><p>如果模块指向一个npm包（即模块的名称不带./），则可能是由于缺少对等项依赖关系引起的。 要解决此问题，请在项目中安装依赖项：</p>
<ul>
<li>npm<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install name-of-the-module</span><br></pre></td></tr></table></figure></div></li>
<li>yarn<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add name-of-the-module</span><br></pre></td></tr></table></figure></div>

</li>
</ul>
<p>有时甚至可能是由于安装损坏导致的。 如果清除缓存不起作用，请尝试删除您的node_modules文件夹，然后再次运行npm install。</p>
<h2 id="12-3-metro配置中缺少扩展"><a href="#12-3-metro配置中缺少扩展" class="headerlink" title="12.3 metro配置中缺少扩展"></a>12.3 metro配置中缺少扩展</h2><p>有时报错是这样的：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: While trying to resolve module &quot;@react-navigation&#x2F;native&quot; from file &quot;&#x2F;path&#x2F;to&#x2F;src&#x2F;App.js&quot;, the package &quot;&#x2F;path&#x2F;to&#x2F;node_modules&#x2F;@react-navigation&#x2F;native&#x2F;package.json&quot; was successfully found. However, this package itself specifies a &quot;main&quot; module field that could not be resolved (&quot;&#x2F;path&#x2F;to&#x2F;node_modules&#x2F;@react-navigation&#x2F;native&#x2F;src&#x2F;index.tsx&quot;</span><br></pre></td></tr></table></figure></div>

<p>如果您具有Metro的自定义配置并且未将ts和tsx指定为有效扩展名，则可能会发生这种情况。 这些扩展名存在于默认配置中。 要检查是否存在此问题，请在项目中查找metro.config.js文件，并检查是否已指定sourceExts选项。 它至少应具有以下配置：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sourceExts: [&#39;js&#39;, &#39;json&#39;, &#39;ts&#39;, &#39;tsx&#39;];</span><br></pre></td></tr></table></figure></div>

<p>如果缺少这些扩展，请添加它们，然后如上节所示清除Metro缓存。</p>
<h2 id="12-4-报错“SyntaxError-in-react-navigation-xxx-xxx-tsx”或“SyntaxError-xxx-react-navigation-xxx-xxx-tsx-Unexpected-token”"><a href="#12-4-报错“SyntaxError-in-react-navigation-xxx-xxx-tsx”或“SyntaxError-xxx-react-navigation-xxx-xxx-tsx-Unexpected-token”" class="headerlink" title="12.4 报错“SyntaxError in @react-navigation/xxx/xxx.tsx”或“SyntaxError: /xxx/@react-navigation/xxx/xxx.tsx: Unexpected token”"></a>12.4 报错“SyntaxError in @react-navigation/xxx/xxx.tsx”或“SyntaxError: /xxx/@react-navigation/xxx/xxx.tsx: Unexpected token”</h2><p>如果您使用的是Metro-react-native-babel-preset软件包的旧版本，则可能会发生这种情况。 修复它的最简单方法是删除node_modules以及锁定文件并重新安装依赖项。</p>
<p>如果使用的是npm：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf node_modules</span><br><span class="line">rm package-lock.json</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure></div>

<p>如果使用的是yarn：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -rf node_modules</span><br><span class="line">rm yarn.lock</span><br><span class="line">yarn</span><br></pre></td></tr></table></figure></div>

<p>您可能还需要按照页面前面的说明清除Metro bundler的缓存。</p>
<h2 id="12-5-报错“Module-‘-…-’-has-no-exported-member-‘xxx’-when-using-TypeScript”"><a href="#12-5-报错“Module-‘-…-’-has-no-exported-member-‘xxx’-when-using-TypeScript”" class="headerlink" title="12.5 报错“Module ‘[…]’ has no exported member ‘xxx’ when using TypeScript”"></a>12.5 报错“Module ‘[…]’ has no exported member ‘xxx’ when using TypeScript”</h2><p>如果您的项目中有旧版本的TypeScript，则可能会发生这种情况。 您可以尝试升级它：</p>
<p>如果使用的是npm：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev typescript</span><br></pre></td></tr></table></figure></div>

<p>如果使用的是yarn：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn add --dev typescript</span><br></pre></td></tr></table></figure></div>

<h2 id="12-6-报错“null-is-not-an-object-evaluating-‘RNGestureHandlerModule-default-Direction’-”"><a href="#12-6-报错“null-is-not-an-object-evaluating-‘RNGestureHandlerModule-default-Direction’-”" class="headerlink" title="12.6 报错“null is not an object (evaluating ‘RNGestureHandlerModule.default.Direction’)”"></a>12.6 报错“null is not an object (evaluating ‘RNGestureHandlerModule.default.Direction’)”</h2><p>如果您未链接react-native-gesture-handler库，则可能会发生此错误和一些类似的错误。</p>
<p>从React Native 0.60开始自动链接，所以如果您手动链接了库，请先取消链接：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">react-native unlink react-native-gesture-handler</span><br></pre></td></tr></table></figure></div>

<p>如果要在iOS上测试并使用Mac，请确保已在ios /文件夹中运行pod install：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ios</span><br><span class="line">pod install</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure></div>
<p>现在，重新编译app并在您的设备或模拟器上进行测试。</p>
<h2 id="12-7-添加视图后，屏幕上看不到任何内容"><a href="#12-7-添加视图后，屏幕上看不到任何内容" class="headerlink" title="12.7 添加视图后，屏幕上看不到任何内容"></a>12.7 添加视图后，屏幕上看不到任何内容</h2><p>如果将容器包装在View中，请确保使用flex：1，将View拉伸以填充容器。</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">import * as React from &#39;react&#39;;</span><br><span class="line">import &#123; View &#125; from &#39;react-native&#39;;</span><br><span class="line">import &#123; NavigationContainer &#125; from &#39;@react-navigation&#x2F;native&#39;;</span><br><span class="line"></span><br><span class="line">export default function App() &#123;</span><br><span class="line">  return (</span><br><span class="line">    &lt;View style&#x3D;&#123;&#123; flex: 1 &#125;&#125;&gt;</span><br><span class="line">      &lt;NavigationContainer&gt;&#123;&#x2F;* ... *&#x2F;&#125;&lt;&#x2F;NavigationContainer&gt;</span><br><span class="line">    &lt;&#x2F;View&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>


<h2 id="12-8-警告：“Non-serializable-values-were-found-in-the-navigation-state”"><a href="#12-8-警告：“Non-serializable-values-were-found-in-the-navigation-state”" class="headerlink" title="12.8 警告：“Non-serializable values were found in the navigation state”"></a>12.8 警告：“Non-serializable values were found in the navigation state”</h2><p>如果您在参数中传递了不可序列化的值，例如类实例，函数等，则会发生这种情况。 在这种情况下，React Navigation警告您，因为这可能会破坏其他功能，例如状态持久性，深层链接等。</p>
<p>在参数中传递函数的常见用例示例如下</p>
<ul>
<li>传递要在标题按钮中使用的回调。 可以使用navigation.setOptions代替。 有关示例，请参见guide for header buttons。</li>
<li>将回调传递到下一个屏幕，可以调用该屏幕将一些数据传回。 通常，您可以使用导航来实现。 有关示例，请参见指南中的guide for params。</li>
<li>将复杂数据传递到另一个屏幕。 无需传递数据参数，您可以将该复杂数据存储在其他位置（例如全局存储），并传递一个ID。 然后，屏幕可以使用ID从全局存储中获取数据。</li>
</ul>
<p>如果您不使用状态持久性或不使用接受参数形式的屏幕的深层链接，则警告不会影响您，您可以放心地忽略它。 要忽略警告，可以使用YellowBox.ignoreWarnings。</p>
<p>例如：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import &#123; YellowBox &#125; from &#39;react-native&#39;;</span><br><span class="line"></span><br><span class="line">YellowBox.ignoreWarnings([</span><br><span class="line">  &#39;Non-serializable values were found in the navigation state&#39;,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure></div>

<h2 id="12-9-连接到Chrome调试器后，应用无法正常运行"><a href="#12-9-连接到Chrome调试器后，应用无法正常运行" class="headerlink" title="12.9 连接到Chrome调试器后，应用无法正常运行"></a>12.9 连接到Chrome调试器后，应用无法正常运行</h2><p>当应用程序连接到Chrome调试器（或其他使用Chrome调试器的工具，例如React Native Debugger）时，您可能会遇到与计时相关的各种问题。</p>
<p>这可能会导致诸如按钮按下需要花费很长时间才能注册或根本无法工作，手势和动画缓慢且有错误等问题。还可能存在其他功能问题，例如promises无法解决，超时和间隔无法正常工作等。也一样</p>
<p>这些问题与React Navigation不相关，而是由于Chrome调试器的工作原理所致。连接到Chrome调试器后，您的整个应用程序将在Chrome上运行，并通过网络上的sockets与本机应用程序进行通信，这可能会导致延迟和与计时相关的问题。</p>
<p>因此，除非您尝试进行调试，否则最好在不连接Chrome调试器的情况下测试该应用。如果您使用的是iOS，则可以使用Safari调试应用程序，该应用程序可以直接在设备上调试该应用程序，并且没有这些问题，尽管它还有其他缺点。</p>
<h1 id="13-局限性"><a href="#13-局限性" class="headerlink" title="13 局限性"></a>13 局限性</h1><p>作为库的潜在用户，重要的是要知道您可以使用和不能使用它。 有了这些知识，您可以选择a different library instead。 我们将在 pitch &amp; anti-pitch讨论高级设计决策，这里我们将介绍一些用例，这些用例要么不被支持，要么很难完成，以至于不可能。 如果以下任何限制是您应用的破坏因素，则React Navigation可能不适合您。</p>
<h2 id="13-1-有限的从右到左（RTL）布局支持"><a href="#13-1-有限的从右到左（RTL）布局支持" class="headerlink" title="13.1 有限的从右到左（RTL）布局支持"></a>13.1 有限的从右到左（RTL）布局支持</h2><p>我们试图在React Navigation中正确处理RTL布局，但是从事React Navigation的团队规模很小，目前我们没有带宽或流程来测试所有针对RTL布局的更改。 因此，您可能会遇到RTL布局问题。</p>
<p>如果您喜欢React Navigation必须提供的功能，但由于此限制而被关闭，我们鼓励您参与其中并获得RTL布局支持的所有权。 </p>
<h2 id="13-2-一些特定于平台的行为"><a href="#13-2-一些特定于平台的行为" class="headerlink" title="13.2 一些特定于平台的行为"></a>13.2 一些特定于平台的行为</h2><p>React Navigation不支持具有3D触摸功能的设备上提供的窥视和弹出功能。</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">wangguangatap</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wangguangatap.github.io/2020/01/27/React-Navigation/">https://wangguangatap.github.io/2020/01/27/React-Navigation/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://wangguangatap.github.io/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wangguangatap.github.io">星脉</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/React/">React    </a><a class="post-meta__tags" href="/tags/App/">App    </a></div><div class="post_share"><div class="social-share" data-image="/img/react/react1.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/01/27/gin%20web%E6%A1%86%E6%9E%B6%E6%89%8B%E5%86%8C/"><img class="prev_cover lazyload" data-src="/img/golang/golang.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Gin框架手册</span></div></a></div><div class="next-post pull_right"><a href="/2020/01/27/MySQL%E4%BC%98%E5%8C%96/"><img class="next_cover lazyload" data-src="/img/mysql/mysql.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>MySQL优化</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/01/27/redux/" title="Redux"><img class="relatedPosts_cover lazyload"data-src="/img/react/react1.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">Redux</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/27/React实战/" title="React实战"><img class="relatedPosts_cover lazyload"data-src="/img/react/react1.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">React实战</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2021 By wangguangatap</div><div class="framework-info"><span>驱动 </span><a target="_blank" rel="noopener" href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>