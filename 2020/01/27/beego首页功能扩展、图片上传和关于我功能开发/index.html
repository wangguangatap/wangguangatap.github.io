<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>(六)beego首页功能扩展、图片上传和关于我功能开发 | 星脉</title><meta name="description" content="(六)beego首页功能扩展、图片上传和关于我功能开发"><meta name="keywords" content="Golang,Web框架"><meta name="author" content="wangguangatap"><meta name="copyright" content="wangguangatap"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="(六)beego首页功能扩展、图片上传和关于我功能开发"><meta name="twitter:description" content="(六)beego首页功能扩展、图片上传和关于我功能开发"><meta name="twitter:image" content="https://wangguangatap.github.io/img/beego/beego.jpeg"><meta property="og:type" content="article"><meta property="og:title" content="(六)beego首页功能扩展、图片上传和关于我功能开发"><meta property="og:url" content="https://wangguangatap.github.io/2020/01/27/beego%E9%A6%96%E9%A1%B5%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E3%80%81%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%85%B3%E4%BA%8E%E6%88%91%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91/"><meta property="og:site_name" content="星脉"><meta property="og:description" content="(六)beego首页功能扩展、图片上传和关于我功能开发"><meta property="og:image" content="https://wangguangatap.github.io/img/beego/beego.jpeg"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://wangguangatap.github.io/2020/01/27/beego%E9%A6%96%E9%A1%B5%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E3%80%81%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%85%B3%E4%BA%8E%E6%88%91%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91/"><link rel="prev" title="(五)beego修改文章、删除文章和标签功能开发" href="https://wangguangatap.github.io/2020/01/27/beego%E4%BF%AE%E6%94%B9%E6%96%87%E7%AB%A0%E3%80%81%E5%88%A0%E9%99%A4%E6%96%87%E7%AB%A0%E5%92%8C%E6%A0%87%E7%AD%BE%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91/"><link rel="next" title="(一)安装 Goland 开发工具" href="https://wangguangatap.github.io/2020/01/27/%E5%AE%89%E8%A3%85Goland%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">星脉</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">66</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">20</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">8</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#首页功能扩展、图片上传和关于我功能开发"><span class="toc_mobile_items-text">首页功能扩展、图片上传和关于我功能开发</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#一-首页功能扩展开发"><span class="toc_mobile_items-text">一 首页功能扩展开发</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-1-修改首页逻辑"><span class="toc_mobile_items-text">1.1 修改首页逻辑</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-1-修改控制器逻辑"><span class="toc_mobile_items-text">1.1.1 修改控制器逻辑</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-1-2-功能扩展逻辑分析"><span class="toc_mobile_items-text">1.1.2 功能扩展逻辑分析</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-2-model-层逻辑实现"><span class="toc_mobile_items-text">1.2 model 层逻辑实现</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-1-逻辑分析"><span class="toc_mobile_items-text">1.2.1 逻辑分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#1-2-2-添加-model-方法"><span class="toc_mobile_items-text">1.2.2 添加 model 方法</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-3-项目运行"><span class="toc_mobile_items-text">1.3 项目运行</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#二-文件上传和图片展示功能"><span class="toc_mobile_items-text">二 文件上传和图片展示功能</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-1-创建数据表"><span class="toc_mobile_items-text">2.1 创建数据表</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-2-实现文件上传功能"><span class="toc_mobile_items-text">2.2 实现文件上传功能</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-1-新增-AlbumController-控制器"><span class="toc_mobile_items-text">2.2.1 新增 AlbumController 控制器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-2-视图层实现"><span class="toc_mobile_items-text">2.2.2 视图层实现</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#2-2-2-1-添加-html-文件"><span class="toc_mobile_items-text">2.2.2.1 添加 html 文件</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#2-2-2-2-js-实现文件上传逻辑"><span class="toc_mobile_items-text">2.2.2.2 js 实现文件上传逻辑</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-3-添加文件上传控制器"><span class="toc_mobile_items-text">2.2.3 添加文件上传控制器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-4-添加相册、文件上传路由"><span class="toc_mobile_items-text">2.2.4 添加相册、文件上传路由</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-5-添加相册-model"><span class="toc_mobile_items-text">2.2.5 添加相册 model</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#2-2-5-1-相册结构体定义"><span class="toc_mobile_items-text">2.2.5.1 相册结构体定义</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-5"><a class="toc_mobile_items-link" href="#2-2-5-2-添加方法"><span class="toc_mobile_items-text">2.2.5.2 添加方法</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-6-项目运行"><span class="toc_mobile_items-text">2.2.6 项目运行</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-3-查看图片"><span class="toc_mobile_items-text">2.3 查看图片</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-1-Model-层添加方法"><span class="toc_mobile_items-text">2.3.1 Model 层添加方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-2-修改控制器方法"><span class="toc_mobile_items-text">2.3.2 修改控制器方法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-3-修改视图层"><span class="toc_mobile_items-text">2.3.3 修改视图层</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-4-项目运行"><span class="toc_mobile_items-text">2.3.4 项目运行</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#三-关于我功能开发及项目总结"><span class="toc_mobile_items-text">三 关于我功能开发及项目总结</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-1-关于我功能开发"><span class="toc_mobile_items-text">3.1 关于我功能开发</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-1-1-添加”关于我”控制器"><span class="toc_mobile_items-text">3.1.1 添加”关于我”控制器</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-1-2-注册关于我路由解析"><span class="toc_mobile_items-text">3.1.2 注册关于我路由解析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-1-3-关于我视图层"><span class="toc_mobile_items-text">3.1.3 关于我视图层</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-2-课程总结"><span class="toc_mobile_items-text">3.2 课程总结</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-1-beego-框架组成"><span class="toc_mobile_items-text">3.2.1 beego 框架组成</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-2-beego-框架调试工具"><span class="toc_mobile_items-text">3.2.2 beego 框架调试工具</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-3-beego-程序执行流程"><span class="toc_mobile_items-text">3.2.3 beego 程序执行流程</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-4-数据库操作"><span class="toc_mobile_items-text">3.2.4 数据库操作</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#3-2-5-beego-项目架构"><span class="toc_mobile_items-text">3.2.5 beego 项目架构</span></a></li></ol></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#首页功能扩展、图片上传和关于我功能开发"><span class="toc-text">首页功能扩展、图片上传和关于我功能开发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一-首页功能扩展开发"><span class="toc-text">一 首页功能扩展开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-修改首页逻辑"><span class="toc-text">1.1 修改首页逻辑</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-修改控制器逻辑"><span class="toc-text">1.1.1 修改控制器逻辑</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-功能扩展逻辑分析"><span class="toc-text">1.1.2 功能扩展逻辑分析</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-model-层逻辑实现"><span class="toc-text">1.2 model 层逻辑实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-1-逻辑分析"><span class="toc-text">1.2.1 逻辑分析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-2-添加-model-方法"><span class="toc-text">1.2.2 添加 model 方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-项目运行"><span class="toc-text">1.3 项目运行</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#二-文件上传和图片展示功能"><span class="toc-text">二 文件上传和图片展示功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-创建数据表"><span class="toc-text">2.1 创建数据表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-实现文件上传功能"><span class="toc-text">2.2 实现文件上传功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-新增-AlbumController-控制器"><span class="toc-text">2.2.1 新增 AlbumController 控制器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-视图层实现"><span class="toc-text">2.2.2 视图层实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-1-添加-html-文件"><span class="toc-text">2.2.2.1 添加 html 文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-2-2-js-实现文件上传逻辑"><span class="toc-text">2.2.2.2 js 实现文件上传逻辑</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-添加文件上传控制器"><span class="toc-text">2.2.3 添加文件上传控制器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-4-添加相册、文件上传路由"><span class="toc-text">2.2.4 添加相册、文件上传路由</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-5-添加相册-model"><span class="toc-text">2.2.5 添加相册 model</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-5-1-相册结构体定义"><span class="toc-text">2.2.5.1 相册结构体定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-5-2-添加方法"><span class="toc-text">2.2.5.2 添加方法</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-6-项目运行"><span class="toc-text">2.2.6 项目运行</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-查看图片"><span class="toc-text">2.3 查看图片</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-Model-层添加方法"><span class="toc-text">2.3.1 Model 层添加方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-修改控制器方法"><span class="toc-text">2.3.2 修改控制器方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-3-修改视图层"><span class="toc-text">2.3.3 修改视图层</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-4-项目运行"><span class="toc-text">2.3.4 项目运行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#三-关于我功能开发及项目总结"><span class="toc-text">三 关于我功能开发及项目总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-关于我功能开发"><span class="toc-text">3.1 关于我功能开发</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-添加”关于我”控制器"><span class="toc-text">3.1.1 添加”关于我”控制器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-注册关于我路由解析"><span class="toc-text">3.1.2 注册关于我路由解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-关于我视图层"><span class="toc-text">3.1.3 关于我视图层</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-课程总结"><span class="toc-text">3.2 课程总结</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-beego-框架组成"><span class="toc-text">3.2.1 beego 框架组成</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-beego-框架调试工具"><span class="toc-text">3.2.2 beego 框架调试工具</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-beego-程序执行流程"><span class="toc-text">3.2.3 beego 程序执行流程</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-4-数据库操作"><span class="toc-text">3.2.4 数据库操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-5-beego-项目架构"><span class="toc-text">3.2.5 beego 项目架构</span></a></li></ol></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(/img/beego/beego.jpeg)"><div id="post-info"><div id="post-title"><div class="posttitle">(六)beego首页功能扩展、图片上传和关于我功能开发</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 发表于 2020-01-27<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> 更新于 2020-05-26</time><span class="post-meta__separator">|</span><span><i class="fa fa-inbox post-meta__icon fa-fw" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/golang/">golang</a></span><div class="post-meta-wordcount"><div class="post-meta-pv-cv"><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>阅读量:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h2 id="首页功能扩展、图片上传和关于我功能开发"><a href="#首页功能扩展、图片上传和关于我功能开发" class="headerlink" title="首页功能扩展、图片上传和关于我功能开发"></a>首页功能扩展、图片上传和关于我功能开发</h2><p>我们最初只是让首页显示第一页的文章数据，如果在访问首页的时候，后面传入相应的参数，那么我们应该根据参数显示对应的内容。</p>
<p>如果浏览器输入首页网址：<a href="http://127.0.0.1:8080/" target="_blank" rel="noopener">http://127.0.0.1:8080/</a>，那么我们显示第一页的文章数据</p>
<p>如果浏览器输入网址是：<a href="http://127.0.0.1:8080/?page=3" target="_blank" rel="noopener">http://127.0.0.1:8080/?page=3</a>，那么我们直接显示第三页的文章数据</p>
<p>如果浏览器输入网址是：<a href="http://127.0.0.1:8080/?tag=go" target="_blank" rel="noopener">http://127.0.0.1:8080/?tag=go</a>，那么我们应该显示所有标签为 go 的文章，同理如果 tag=web，我们应该显示所有标签为 web 的文章。</p>
<p>接下来我们就去改进首页的功能。</p>
<h2 id="一-首页功能扩展开发"><a href="#一-首页功能扩展开发" class="headerlink" title="一 首页功能扩展开发"></a>一 首页功能扩展开发</h2><h3 id="1-1-修改首页逻辑"><a href="#1-1-修改首页逻辑" class="headerlink" title="1.1 修改首页逻辑"></a>1.1 修改首页逻辑</h3><h4 id="1-1-1-修改控制器逻辑"><a href="#1-1-1-修改控制器逻辑" class="headerlink" title="1.1.1 修改控制器逻辑"></a>1.1.1 修改控制器逻辑</h4><p>我们首先修改 home_controller.go 文件中的处理，修改代码如下：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controllers</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"myblogweb/models"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> HomeController <span class="keyword">struct</span> &#123;</span><br><span class="line">	<span class="comment">//beego.Controller</span></span><br><span class="line">	BaseController</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *HomeController)</span> <span class="title">Get</span><span class="params">()</span></span> &#123;</span><br><span class="line">	tag := this.GetString(<span class="string">"tag"</span>)</span><br><span class="line">	fmt.Println(<span class="string">"tag:"</span>, tag)</span><br><span class="line">	page, _ := this.GetInt(<span class="string">"page"</span>)</span><br><span class="line">	<span class="keyword">var</span> artList []models.Article</span><br><span class="line">	<span class="keyword">if</span> <span class="built_in">len</span>(tag) &gt; <span class="number">0</span> &#123;</span><br><span class="line">		<span class="comment">//按照指定的标签搜索</span></span><br><span class="line">		artList, _ = models.QueryArticlesWithTag(tag)</span><br><span class="line">		this.Data[<span class="string">"HasFooter"</span>] = <span class="literal">false</span></span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> page &lt;= <span class="number">0</span> &#123;</span><br><span class="line">			page = <span class="number">1</span></span><br><span class="line">		&#125;</span><br><span class="line">		artList, _ = models.FindArticleWithPage(page)</span><br><span class="line">		this.Data[<span class="string">"PageCode"</span>] = models.ConfigHomeFooterPageCode(page)</span><br><span class="line">		this.Data[<span class="string">"HasFooter"</span>] = <span class="literal">true</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"IsLogin:"</span>, this.IsLogin, this.Loginuser)</span><br><span class="line">	this.Data[<span class="string">"Content"</span>] = models.MakeHomeBlocks(artList, this.IsLogin)</span><br><span class="line">	this.TplName = <span class="string">"home.html"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="1-1-2-功能扩展逻辑分析"><a href="#1-1-2-功能扩展逻辑分析" class="headerlink" title="1.1.2 功能扩展逻辑分析"></a>1.1.2 功能扩展逻辑分析</h4><p>我们先接收 tag 的值和 page 的值：<br>那么有三种情况： 1. 如果 tag 有值，page 就不会有值。比如：<a href="http://127.0.0.1:8080/?pag=web" target="_blank" rel="noopener">http://127.0.0.1:8080/?pag=web</a> 2. 如果 page 有值，那么 tag 就不会有值。比如：<a href="http://127.0.0.1:8080/?page=3" target="_blank" rel="noopener">http://127.0.0.1:8080/?page=3</a> 3. 就是用户直接访问首页，没有传入 tag 也没有传入 page：<a href="http://127.0.0.1:8080" target="_blank" rel="noopener">http://127.0.0.1:8080</a><br>如果是第一种情况，那么我们应该按照 tag 进行搜索。如果是第二种情况就按照页数查询。如果是第三种就默认按照分页查询，只是查询第一页。</p>
<h3 id="1-2-model-层逻辑实现"><a href="#1-2-model-层逻辑实现" class="headerlink" title="1.2 model 层逻辑实现"></a>1.2 model 层逻辑实现</h3><h4 id="1-2-1-逻辑分析"><a href="#1-2-1-逻辑分析" class="headerlink" title="1.2.1 逻辑分析"></a>1.2.1 逻辑分析</h4><p>接下来我们去实现按照 tag 进行查询，这里有个复杂的地方，就是我们在写文章的手，标签可能有一个，也肯能有多个，如果是多个，我们是按照&amp;连接的，比如：go&amp;socket。那么在按照标签查询的时候，就要分为 4 种情况：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">通过标签查询首页的数据</span><br><span class="line">有四种情况</span><br><span class="line">   1.左右两边有&amp;符和其他符号</span><br><span class="line">   2.左边有&amp;符号和其他符号，同时右边没有任何符号</span><br><span class="line">   3.右边有&amp;符号和其他符号，同时左边没有任何符号</span><br><span class="line">   4.左右两边都没有符号</span><br><span class="line">通过%去匹配任意多个字符，至少是一个</span><br></pre></td></tr></table></figure></div>

<h4 id="1-2-2-添加-model-方法"><a href="#1-2-2-添加-model-方法" class="headerlink" title="1.2.2 添加 model 方法"></a>1.2.2 添加 model 方法</h4><p>我们在 article_model.go 文件中，添加一个方法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//--------------按照标签查询--------------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">QueryArticlesWithTag</span><span class="params">(tag <span class="keyword">string</span>)</span> <span class="params">([]Article, error)</span></span> &#123;</span><br><span class="line"></span><br><span class="line">	sql := <span class="string">" where tags like '%&amp;"</span> + tag + <span class="string">"&amp;%'"</span></span><br><span class="line">	sql += <span class="string">" or tags like '%&amp;"</span> + tag + <span class="string">"'"</span></span><br><span class="line">	sql += <span class="string">" or tags like '"</span> + tag + <span class="string">"&amp;%'"</span></span><br><span class="line">	sql += <span class="string">" or tags like '"</span> + tag + <span class="string">"'"</span></span><br><span class="line">	fmt.Println(sql)</span><br><span class="line">	<span class="keyword">return</span> QueryArticlesWithCon(sql)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="1-3-项目运行"><a href="#1-3-项目运行" class="headerlink" title="1.3 项目运行"></a>1.3 项目运行</h3><p>前端页面不用修改，我们打开浏览器输入以下网址：<a href="http://127.0.0.1:8080?tag=web" target="_blank" rel="noopener">http://127.0.0.1:8080?tag=web</a></p>
<p><a href="/img/beego/WX20190524-103729@2x.png" data-fancybox="group" data-caption="功能扩展演示" class="fancybox"><img alt="功能扩展演示" data-src="/img/beego/WX20190524-103729@2x.png" class="lazyload" title="功能扩展演示"></a></p>
<p>可以看到查询出 web 标签的三篇文章，重新输入网址：<a href="http://127.0.0.1:8080?tag=http" target="_blank" rel="noopener">http://127.0.0.1:8080?tag=http</a>http 标签下的三篇文章也被查询出来了。</p>
<p><a href="/img/beego/WX20190524-104605@2x.png" data-fancybox="group" data-caption="http标签查询结果" class="fancybox"><img alt="http标签查询结果" data-src="/img/beego/WX20190524-104605@2x.png" class="lazyload" title="http标签查询结果"></a></p>
<p>下面我们输入以下页码：<a href="http://127.0.0.1:8080?page=3" target="_blank" rel="noopener">http://127.0.0.1:8080?page=3</a></p>
<p><a href="/img/beego/WX20190524-104754@2x.png" data-fancybox="group" data-caption="通过页码获取" class="fancybox"><img alt="通过页码获取" data-src="/img/beego/WX20190524-104754@2x.png" class="lazyload" title="通过页码获取"></a></p>
<h2 id="二-文件上传和图片展示功能"><a href="#二-文件上传和图片展示功能" class="headerlink" title="二 文件上传和图片展示功能"></a>二 文件上传和图片展示功能</h2><p>上节内容我们学习了首页扩功能，本节课我们继续开发实现新的功能–文件上传和图片展示功能。在实际案例中，提供有相册展示功能，相册功能展示的图片需要用到文件上传，我们来实际开发实现。</p>
<h3 id="2-1-创建数据表"><a href="#2-1-创建数据表" class="headerlink" title="2.1 创建数据表"></a>2.1 创建数据表</h3><p>首先我们要在数据库中创建数据表，要想存储图片，我们需要图片的 id，图片的路径位置，图片的名字等等。所在在 utils 工具包下的 mysqlUtil.go 文件中，添加创建数据表的方法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//--------图片--------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">CreateTableWithAlbum</span><span class="params">()</span></span> &#123;</span><br><span class="line">	sql := <span class="string">`create table if not exists album(</span></span><br><span class="line"><span class="string">		id int(4) primary key auto_increment not null,</span></span><br><span class="line"><span class="string">		filepath varchar(255),</span></span><br><span class="line"><span class="string">		filename varchar(64),</span></span><br><span class="line"><span class="string">		status int(4),</span></span><br><span class="line"><span class="string">		createtime int(10)</span></span><br><span class="line"><span class="string">		);`</span></span><br><span class="line">	ModifyDB(sql)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<p>并且在初始化数据库的方法中进行调用：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InitMysql</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"InitMysql...."</span>)</span><br><span class="line">	<span class="keyword">if</span> db == <span class="literal">nil</span> &#123;</span><br><span class="line">		db, _ = sql.Open(<span class="string">"mysql"</span>, <span class="string">"root:hanru1314@tcp(127.0.0.1:3306)/myblogweb"</span>)</span><br><span class="line">		CreateTableWithUser()</span><br><span class="line">		CreateTableWithArticle()</span><br><span class="line">		CreateTableWithAlbum()</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h3 id="2-2-实现文件上传功能"><a href="#2-2-实现文件上传功能" class="headerlink" title="2.2 实现文件上传功能"></a>2.2 实现文件上传功能</h3><h4 id="2-2-1-新增-AlbumController-控制器"><a href="#2-2-1-新增-AlbumController-控制器" class="headerlink" title="2.2.1 新增 AlbumController 控制器"></a>2.2.1 新增 AlbumController 控制器</h4><p>然后我们创建一个新的 go 文件，album_controller.go</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controllers</span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"myblog/models"</span></span><br><span class="line">	<span class="string">"github.com/opentracing/opentracing-go/log"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> AlbumController <span class="keyword">struct</span> &#123;</span><br><span class="line">	BaseController</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *AlbumController)</span> <span class="title">Get</span><span class="params">()</span></span> &#123;</span><br><span class="line">	this.TplName=<span class="string">"album.html"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="2-2-2-视图层实现"><a href="#2-2-2-视图层实现" class="headerlink" title="2.2.2 视图层实现"></a>2.2.2 视图层实现</h4><h5 id="2-2-2-1-添加-html-文件"><a href="#2-2-2-1-添加-html-文件" class="headerlink" title="2.2.2.1 添加 html 文件"></a>2.2.2.1 添加 html 文件</h5><p>接下来我们去写 html 页面，在 views 目录下创建一个新的 html 页面：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>相册<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../static/js/lib/jquery-3.3.1.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../static/js/lib/jquery.url.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"../static/js/blog.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"../static/css/blogsheet.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    &#123;&#123;template "block/nav.html" .&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"main"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"album-upload-file"</span> <span class="attr">name</span>=<span class="string">"upload"</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">id</span>=<span class="string">"album-upload-button"</span> <span class="attr">value</span>=<span class="string">"提交文件"</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h5 id="2-2-2-2-js-实现文件上传逻辑"><a href="#2-2-2-2-js-实现文件上传逻辑" class="headerlink" title="2.2.2.2 js 实现文件上传逻辑"></a>2.2.2.2 js 实现文件上传逻辑</h5><p>然后我们需要编写点击按钮之后的脚本代码，在 blog.js 文件中继续添加脚本：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//文件</span></span><br><span class="line">    $(<span class="string">"#album-upload-button"</span>).click(function () &#123;</span><br><span class="line">        <span class="keyword">var</span> filedata = $(<span class="string">"#album-upload-file"</span>).val();</span><br><span class="line">        <span class="keyword">if</span> (filedata.length &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">            alert(<span class="string">"请选择文件!"</span>);</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//文件上传通过Formdata去储存文件的数据</span></span><br><span class="line">        <span class="keyword">var</span> data = <span class="built_in">new</span> FormData()</span><br><span class="line">        data.<span class="built_in">append</span>(<span class="string">"upload"</span>, $(<span class="string">"#album-upload-file"</span>)[<span class="number">0</span>].files[<span class="number">0</span>]);</span><br><span class="line">        alert(data)</span><br><span class="line">        <span class="keyword">var</span> urlStr = <span class="string">"/upload"</span></span><br><span class="line">        $.ajax(&#123;</span><br><span class="line">            url: urlStr,</span><br><span class="line">            <span class="keyword">type</span>: <span class="string">"post"</span>,</span><br><span class="line">            dataType: <span class="string">"json"</span>,</span><br><span class="line">            contentType: <span class="literal">false</span>,</span><br><span class="line">            data: data,</span><br><span class="line">            processData: <span class="literal">false</span>,</span><br><span class="line">            success: function (data, status) &#123;</span><br><span class="line">                alert(<span class="string">":data:"</span> + data.message);</span><br><span class="line">                <span class="keyword">if</span> (data.code == <span class="number">1</span>) &#123;</span><br><span class="line">                    setTimeout(function () &#123;</span><br><span class="line">                        window.location.href = <span class="string">"/album"</span></span><br><span class="line">                    &#125;, <span class="number">1000</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            error: function (data, status) &#123;</span><br><span class="line">                alert(<span class="string">"err:"</span> + data.message + <span class="string">":"</span> + status)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br></pre></td></tr></table></figure></div>

<h4 id="2-2-3-添加文件上传控制器"><a href="#2-2-3-添加文件上传控制器" class="headerlink" title="2.2.3 添加文件上传控制器"></a>2.2.3 添加文件上传控制器</h4><p>此时我们需要新建一个文件上传的 controller，upload_controller.go</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controllers</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">	<span class="string">"fmt"</span></span><br><span class="line">	<span class="string">"time"</span></span><br><span class="line">	<span class="string">"path/filepath"</span></span><br><span class="line">	<span class="string">"os"</span></span><br><span class="line">	<span class="string">"io"</span></span><br><span class="line">	<span class="string">"myblog/models"</span></span><br><span class="line">)</span><br><span class="line"><span class="keyword">type</span> UploadController <span class="keyword">struct</span> &#123;</span><br><span class="line">	BaseController</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *UploadController)</span> <span class="title">Post</span><span class="params">()</span></span> &#123;</span><br><span class="line">	fmt.Println(<span class="string">"fileupload..."</span>)</span><br><span class="line">	fileData, fileHeader, err := this.GetFile(<span class="string">"upload"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		this.responseErr(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">"name:"</span>, fileHeader.Filename, fileHeader.Size)</span><br><span class="line">	fmt.Println(fileData)</span><br><span class="line">	now := time.Now()</span><br><span class="line">	fmt.Println(<span class="string">"ext:"</span>, filepath.Ext(fileHeader.Filename))</span><br><span class="line">	fileType := <span class="string">"other"</span></span><br><span class="line">	<span class="comment">//判断后缀为图片的文件，如果是图片我们才存入到数据库中</span></span><br><span class="line">	fileExt := filepath.Ext(fileHeader.Filename)</span><br><span class="line">	<span class="keyword">if</span> fileExt == <span class="string">".jpg"</span> || fileExt == <span class="string">".png"</span> || fileExt == <span class="string">".gif"</span> || fileExt == <span class="string">".jpeg"</span> &#123;</span><br><span class="line">		fileType = <span class="string">"img"</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//文件夹路径</span></span><br><span class="line">	fileDir := fmt.Sprintf(<span class="string">"static/upload/%s/%d/%d/%d"</span>, fileType, now.Year(), now.Month(), now.Day())</span><br><span class="line">	<span class="comment">//ModePerm是0777，这样拥有该文件夹路径的执行权限</span></span><br><span class="line">	err = os.MkdirAll(fileDir, os.ModePerm)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		this.responseErr(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//文件路径</span></span><br><span class="line">	timeStamp := time.Now().Unix()</span><br><span class="line">	fileName := fmt.Sprintf(<span class="string">"%d-%s"</span>, timeStamp, fileHeader.Filename)</span><br><span class="line">	filePathStr := filepath.Join(fileDir, fileName)</span><br><span class="line">	desFile, err := os.Create(filePathStr)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		this.responseErr(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//将浏览器客户端上传的文件拷贝到本地路径的文件里面</span></span><br><span class="line">	_, err = io.Copy(desFile, fileData)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		this.responseErr(err)</span><br><span class="line">		<span class="keyword">return</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> fileType == <span class="string">"img"</span> &#123;</span><br><span class="line">		album := models.Album&#123;<span class="number">0</span>, filePathStr, fileName, <span class="number">0</span>, timeStamp&#125;</span><br><span class="line">		models.InsertAlbum(album)</span><br><span class="line">	&#125;</span><br><span class="line">	this.Data[<span class="string">"json"</span>] = <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">"code"</span>: <span class="number">1</span>, <span class="string">"message"</span>: <span class="string">"上传成功"</span>&#125;</span><br><span class="line">	this.ServeJSON()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *UploadController)</span> <span class="title">responseErr</span><span class="params">(err error)</span></span> &#123;</span><br><span class="line">	this.Data[<span class="string">"json"</span>] = <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;&#123;<span class="string">"code"</span>: <span class="number">0</span>, <span class="string">"message"</span>: err&#125;</span><br><span class="line">	this.ServeJSON()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="2-2-4-添加相册、文件上传路由"><a href="#2-2-4-添加相册、文件上传路由" class="headerlink" title="2.2.4 添加相册、文件上传路由"></a>2.2.4 添加相册、文件上传路由</h4><p>最后要注册路由：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//相册</span></span><br><span class="line">beego.Router(<span class="string">"/album"</span>, &amp;controllers.AlbumController&#123;&#125;)</span><br><span class="line"><span class="comment">//文件上传</span></span><br><span class="line">beego.Router(<span class="string">"/upload"</span>, &amp;controllers.UploadController&#123;&#125;)</span><br></pre></td></tr></table></figure></div>

<h4 id="2-2-5-添加相册-model"><a href="#2-2-5-添加相册-model" class="headerlink" title="2.2.5 添加相册 model"></a>2.2.5 添加相册 model</h4><h5 id="2-2-5-1-相册结构体定义"><a href="#2-2-5-1-相册结构体定义" class="headerlink" title="2.2.5.1 相册结构体定义"></a>2.2.5.1 相册结构体定义</h5><p>接下来我们创建一个新的 model，album_model.go 文件：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Album <span class="keyword">struct</span> &#123;</span><br><span class="line">	Id         <span class="keyword">int</span></span><br><span class="line">	Filepath   <span class="keyword">string</span></span><br><span class="line">	Filename   <span class="keyword">string</span></span><br><span class="line">	Status     <span class="keyword">int</span></span><br><span class="line">	Createtime <span class="keyword">int64</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h5 id="2-2-5-2-添加方法"><a href="#2-2-5-2-添加方法" class="headerlink" title="2.2.5.2 添加方法"></a>2.2.5.2 添加方法</h5><p>我们需要在 album_model.go 文件中，添加插入数据的方法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//-------插入图片---------------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">InsertAlbum</span><span class="params">(album Album)</span> <span class="params">(<span class="keyword">int64</span>, error)</span></span> &#123;</span><br><span class="line">	<span class="keyword">return</span> utils.ModifyDB(<span class="string">"insert into album(filepath,filename,status,createtime)values(?,?,?,?)"</span>,</span><br><span class="line">		album.Filepath, album.Filename, album.Status, album.Createtime)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="2-2-6-项目运行"><a href="#2-2-6-项目运行" class="headerlink" title="2.2.6 项目运行"></a>2.2.6 项目运行</h4><p>重启项目后，点击图片按钮，然后选择一张图片：<br><a href="/img/beego/WX20190524-114125@2x.png" data-fancybox="group" data-caption="文件上传效果" class="fancybox"><img alt="文件上传效果" data-src="/img/beego/WX20190524-114125@2x.png" class="lazyload" title="文件上传效果"></a></p>
<p>点击提交文件按钮后，可以上传图片了。</p>
<p><a href="/img/beego/WX20190524-114242@2x.png" data-fancybox="group" data-caption="上传图片成功" class="fancybox"><img alt="上传图片成功" data-src="/img/beego/WX20190524-114242@2x.png" class="lazyload" title="上传图片成功"></a></p>
<p>我们可以查询一下数据库：<br><a href="/img/beego/WX20190524-114318@2x.png" data-fancybox="group" data-caption="数据库验证" class="fancybox"><img alt="数据库验证" data-src="/img/beego/WX20190524-114318@2x.png" class="lazyload" title="数据库验证"></a></p>
<h3 id="2-3-查看图片"><a href="#2-3-查看图片" class="headerlink" title="2.3 查看图片"></a>2.3 查看图片</h3><p>通过上面的操作已经能够上传文件了，那么如何显示文件呢？当点击图片标签的时候，除了有上传操作，还应该可以显示已经存储的图片。</p>
<h4 id="2-3-1-Model-层添加方法"><a href="#2-3-1-Model-层添加方法" class="headerlink" title="2.3.1 Model 层添加方法"></a>2.3.1 Model 层添加方法</h4><p>我们现在 album_model.go 文件中，添加查找图片数据的方法：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//--------查询图片----------</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">FindAllAlbums</span><span class="params">()</span> <span class="params">([]Album, error)</span></span> &#123;</span><br><span class="line">	rows, err := utils.QueryDB(<span class="string">"select id,filepath,filename,status,createtime from album"</span>)</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">var</span> albums []Album</span><br><span class="line">	<span class="keyword">for</span> rows.Next() &#123;</span><br><span class="line">		id := <span class="number">0</span></span><br><span class="line">		filepath := <span class="string">""</span></span><br><span class="line">		filename := <span class="string">""</span></span><br><span class="line">		status := <span class="number">0</span></span><br><span class="line">		<span class="keyword">var</span> createtime <span class="keyword">int64</span></span><br><span class="line">		createtime = <span class="number">0</span></span><br><span class="line">		rows.Scan(&amp;id, &amp;filepath, &amp;filename, &amp;status, &amp;createtime)</span><br><span class="line">		album := Album&#123;id, filepath, filename, status, createtime&#125;</span><br><span class="line">		albums = <span class="built_in">append</span>(albums, album)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> albums, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="2-3-2-修改控制器方法"><a href="#2-3-2-修改控制器方法" class="headerlink" title="2.3.2 修改控制器方法"></a>2.3.2 修改控制器方法</h4><p>接下来，我们修改 album_controller.go 文件中的 Get()方法，</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(this *AlbumController)</span> <span class="title">Get</span><span class="params">()</span></span> &#123;</span><br><span class="line">	albums,err := models.FindAllAlbums()</span><br><span class="line">	<span class="keyword">if</span> err !=<span class="literal">nil</span>&#123;</span><br><span class="line">		log.Error(err)</span><br><span class="line">	&#125;</span><br><span class="line">	this.Data[<span class="string">"Album"</span>] = albums</span><br><span class="line">	this.TplName=<span class="string">"album.html"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="2-3-3-修改视图层"><a href="#2-3-3-修改视图层" class="headerlink" title="2.3.3 修改视图层"></a>2.3.3 修改视图层</h4><p>最后我们还要修改一下 html 页面，在 album.html 中，添加以下内容：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"album-box"</span>&gt;</span></span><br><span class="line">  &#123;&#123;range .Album&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"album-item"</span> <span class="attr">style</span>=<span class="string">'background-image: url("&#123;&#123;.Filepath&#125;&#125;");'</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  &#123;&#123;end&#125;&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h4 id="2-3-4-项目运行"><a href="#2-3-4-项目运行" class="headerlink" title="2.3.4 项目运行"></a>2.3.4 项目运行</h4><p>我们上传几张图片后，刷新页面：<br><a href="/img/beego/WX20190524-114301@2x.png" data-fancybox="group" data-caption="图片查看" class="fancybox"><img alt="图片查看" data-src="/img/beego/WX20190524-114301@2x.png" class="lazyload" title="图片查看"></a></p>
<h2 id="三-关于我功能开发及项目总结"><a href="#三-关于我功能开发及项目总结" class="headerlink" title="三 关于我功能开发及项目总结"></a>三 关于我功能开发及项目总结</h2><p>本节课内容我们来开发完成本系列课程的最后一个功能–关于我页面的功能开发，同时对本系列课程内容做一个回顾与总结。</p>
<h3 id="3-1-关于我功能开发"><a href="#3-1-关于我功能开发" class="headerlink" title="3.1 关于我功能开发"></a>3.1 关于我功能开发</h3><h4 id="3-1-1-添加”关于我”控制器"><a href="#3-1-1-添加”关于我”控制器" class="headerlink" title="3.1.1 添加”关于我”控制器"></a>3.1.1 添加”关于我”控制器</h4><p>首先创建一个新的 go 文件，aboutme_controller.go</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> controllers</span><br><span class="line"><span class="keyword">type</span> AboutMeController <span class="keyword">struct</span> &#123;</span><br><span class="line">	BaseController</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *AboutMeController)</span> <span class="title">Get</span><span class="params">()</span></span> &#123;</span><br><span class="line">	c.Data[<span class="string">"wechat"</span>] = <span class="string">"微信：13167582311"</span></span><br><span class="line">	c.Data[<span class="string">"qq"</span>] = <span class="string">"QQ：861574834"</span></span><br><span class="line">	c.Data[<span class="string">"tel"</span>] = <span class="string">"Tel：13167582311"</span></span><br><span class="line">	c.TplName = <span class="string">"aboultme.html"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div>

<h4 id="3-1-2-注册关于我路由解析"><a href="#3-1-2-注册关于我路由解析" class="headerlink" title="3.1.2 注册关于我路由解析"></a>3.1.2 注册关于我路由解析</h4><p>然后不要忘记注册路由：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">go</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//关于我</span></span><br><span class="line">beego.Router(<span class="string">"/aboutme"</span>, &amp;controllers.AboutMeController&#123;&#125;)</span><br></pre></td></tr></table></figure></div>

<h4 id="3-1-3-关于我视图层"><a href="#3-1-3-关于我视图层" class="headerlink" title="3.1.3 关于我视图层"></a>3.1.3 关于我视图层</h4><p>然后我们要写一个 html 页面，aboultme.html：</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">html</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>&#123;&#123;.Title&#125;&#125;<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"../static/css/blogsheet.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"../static/css/lib/highlight.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    &#123;&#123;template "block/nav.html" .&#125;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"aboutme"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://7xtcwd.com1.z0.glb.clouddn.com/wechat_avator.png"</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"myt"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"myp"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://&#123;&#123;.wechat&#125;&#125;"</span>&gt;</span>&#123;&#123;.wechat&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"myp"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://&#123;&#123;.qq&#125;&#125;"</span>&gt;</span>&#123;&#123;.qq&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">class</span>=<span class="string">"myp"</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://&#123;&#123;.tel&#125;&#125;"</span>&gt;</span>&#123;&#123;.tel&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></div>

<h3 id="3-2-课程总结"><a href="#3-2-课程总结" class="headerlink" title="3.2 课程总结"></a>3.2 课程总结</h3><p>经过了 16 节的课程内容，我们完成了使用 Beego 框架开发完成了一个博客系统。通过该项目，以期大家能够掌握 Beego 框架的使用方法。现在我们来回顾一下 Beego 框架开发一个 web 项目所需要掌握的一些重要知识点。</p>
<h4 id="3-2-1-beego-框架组成"><a href="#3-2-1-beego-框架组成" class="headerlink" title="3.2.1 beego 框架组成"></a>3.2.1 beego 框架组成</h4><p>Beego 框架的八大模块分别是<strong>cache，config，context，httplibs，logs，orm，session，toolbox</strong>等模块组合而成。模块之间高度解耦，依赖性低。</p>
<h4 id="3-2-2-beego-框架调试工具"><a href="#3-2-2-beego-框架调试工具" class="headerlink" title="3.2.2 beego 框架调试工具"></a>3.2.2 beego 框架调试工具</h4><p>Beego 框架的项目管理工具 Bee 工具的使用，可以方便开发者管理、调试、打包项目，自动生成项目目录结构等。</p>
<h4 id="3-2-3-beego-程序执行流程"><a href="#3-2-3-beego-程序执行流程" class="headerlink" title="3.2.3 beego 程序执行流程"></a>3.2.3 beego 程序执行流程</h4><p><strong>Beego 框架执行流程：</strong>Beego 框架的程序执行流程如下图所示。<br><a href="/img/beego/WX20190527-103955@2x.png" data-fancybox="group" data-caption="beego框架执行流程" class="fancybox"><img alt="beego框架执行流程" data-src="/img/beego/WX20190527-103955@2x.png" class="lazyload" title="beego框架执行流程"></a></p>
<h4 id="3-2-4-数据库操作"><a href="#3-2-4-数据库操作" class="headerlink" title="3.2.4 数据库操作"></a>3.2.4 数据库操作</h4><ul>
<li>数据库连接：<ul>
<li>驱动：beego 中的 orm 支持 MySQL，Sqlite3、PostgreSQL。</li>
<li>用户名、密码、主机、端口号、数据库名称等的配置。</li>
</ul>
</li>
<li>数据库操作：<ul>
<li>sql 语句</li>
<li>条件查询</li>
<li>统计功能</li>
<li>增加（insert）、删除（delete）、修改（update）、查询（select）</li>
<li>模糊查询</li>
<li>表关联</li>
</ul>
</li>
</ul>
<h4 id="3-2-5-beego-项目架构"><a href="#3-2-5-beego-项目架构" class="headerlink" title="3.2.5 beego 项目架构"></a>3.2.5 beego 项目架构</h4><ul>
<li><p><strong>mvc 模式：</strong>m（model）模型层，v（view）视图层，c（controller）控制器层。</p>
</li>
<li><p><strong>路由解析：</strong></p>
<ul>
<li>默认路由：beego 模块自带 Post、Put、Delete、Head、Options、Patch 等网络请求类型的对应方法</li>
<li>自动路由（自动映射到 Get、Post、Put、Delete、Head、Options、Patch 等方法。</li>
<li>正则表达式路由（支持正则表达式及变量）</li>
<li>自定义路由：开发者自己指定路由解析方法</li>
</ul>
</li>
<li><p><strong>Session 处理：</strong></p>
<ul>
<li><p>两种管理方式：</p>
<ul>
<li>配置文件配置 session 相关配置项</li>
<li>在程序中通过 SessionConfig 中进行配置</li>
</ul>
</li>
<li><p>操作方法：</p>
<ul>
<li>SetSession：设置 session 值</li>
<li>GetSession：获取 session 值</li>
<li>DelSession：删除 session 值</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Views 视图模板：</strong></p>
<ul>
<li><p>views 目录存放视图模板文件</p>
</li>
<li><p>controller.TplName 指定渲染的页面模板文件全称</p>
</li>
<li><p>controller.Data[“param”]为模板页面的变量赋值</p>
</li>
<li><p>模板中使用 ** **</p>
</li>
</ul>
</li>
</ul>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">wangguangatap</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://wangguangatap.github.io/2020/01/27/beego%E9%A6%96%E9%A1%B5%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E3%80%81%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%85%B3%E4%BA%8E%E6%88%91%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91/">https://wangguangatap.github.io/2020/01/27/beego%E9%A6%96%E9%A1%B5%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E3%80%81%E5%9B%BE%E7%89%87%E4%B8%8A%E4%BC%A0%E5%92%8C%E5%85%B3%E4%BA%8E%E6%88%91%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://wangguangatap.github.io/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://wangguangatap.github.io">星脉</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Golang/">Golang    </a><a class="post-meta__tags" href="/tags/Web%E6%A1%86%E6%9E%B6/">Web框架    </a></div><div class="post_share"><div class="social-share" data-image="/img/beego/beego.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付寶"><div class="post-qr-code__desc">支付寶</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/2020/01/27/beego%E4%BF%AE%E6%94%B9%E6%96%87%E7%AB%A0%E3%80%81%E5%88%A0%E9%99%A4%E6%96%87%E7%AB%A0%E5%92%8C%E6%A0%87%E7%AD%BE%E5%8A%9F%E8%83%BD%E5%BC%80%E5%8F%91/"><img class="prev_cover lazyload" data-src="/img/beego/beego.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>(五)beego修改文章、删除文章和标签功能开发</span></div></a></div><div class="next-post pull_right"><a href="/2020/01/27/%E5%AE%89%E8%A3%85Goland%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/"><img class="next_cover lazyload" data-src="/img/golang/golang.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>(一)安装 Goland 开发工具</span></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> 相关推荐</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/2020/01/27/beego框架介绍和流程分析/" title="(一)beego框架介绍和流程分析"><img class="relatedPosts_cover lazyload"data-src="/img/beego/beego.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">(一)beego框架介绍和流程分析</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/27/beego框架总结及数据库连接配置/" title="(二)beego框架总结及数据库连接配置"><img class="relatedPosts_cover lazyload"data-src="/img/beego/beego.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">(二)beego框架总结及数据库连接配置</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/27/beego项目搭建、登录注册和Session功能开发 /" title="(三)beego项目搭建、登录注册和Session功能开发"><img class="relatedPosts_cover lazyload"data-src="/img/beego/beego.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">(三)beego项目搭建、登录注册和Session功能开发</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/27/beego写文章、项目首页和查看文章详情功能开发/" title="(四)beego写文章、项目首页和查看文章详情功能开发"><img class="relatedPosts_cover lazyload"data-src="/img/beego/beego.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">(四)beego写文章、项目首页和查看文章详情功能开发</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/27/beego修改文章、删除文章和标签功能开发/" title="(五)beego修改文章、删除文章和标签功能开发"><img class="relatedPosts_cover lazyload"data-src="/img/beego/beego.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">(五)beego修改文章、删除文章和标签功能开发</div></div></a></div><div class="relatedPosts_item"><a href="/2020/01/27/golang/" title="Golang基础"><img class="relatedPosts_cover lazyload"data-src="/img/golang/golang.jpeg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-01-27</div><div class="relatedPosts_title">Golang基础</div></div></a></div></div><div class="clear_both"></div></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By wangguangatap</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script id="ribbon_piao" mobile="false" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/piao.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>